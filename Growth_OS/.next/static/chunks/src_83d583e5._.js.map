{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/liyao/Code/workwork/frontend/Growth_OS/src/lib/constants.ts"],"sourcesContent":["import { TagType } from '@/types'\n\nexport const TAG_COLORS: Record<TagType, string> = {\n  ai: 'bg-[#FFDCF9] text-tag-ai',\n  crypto: 'bg-[#C7FFCC] text-tag-crypto', \n  education: 'bg-[#ABD5FF] text-tag-education',\n}\n\nexport const FILTER_OPTIONS = [\n  { key: 'time' as const, label: 'Time' },\n  { key: 'price' as const, label: 'Price' },\n  { key: 'likes' as const, label: 'Likes' },\n  { key: 'views' as const, label: 'Views' },\n]\n\nexport const DEFAULT_PROJECT_IMAGE = '/project-image.png'\n\nexport const BRAND_LOGO_URL = '/growthos-logo-new.png'\n\nexport const DEFAULT_USER = {\n  username: 'Username',\n  walletAddress: 'Wallet Address',\n  avatar: 'https://pbs.twimg.com/profile_images/1912362795879809025/HbzzOBdl_400x400.jpg'\n}"],"names":[],"mappings":";;;;;;;AAEO,MAAM,aAAsC;IACjD,IAAI;IACJ,QAAQ;IACR,WAAW;AACb;AAEO,MAAM,iBAAiB;IAC5B;QAAE,KAAK;QAAiB,OAAO;IAAO;IACtC;QAAE,KAAK;QAAkB,OAAO;IAAQ;IACxC;QAAE,KAAK;QAAkB,OAAO;IAAQ;IACxC;QAAE,KAAK;QAAkB,OAAO;IAAQ;CACzC;AAEM,MAAM,wBAAwB;AAE9B,MAAM,iBAAiB;AAEvB,MAAM,eAAe;IAC1B,UAAU;IACV,eAAe;IACf,QAAQ;AACV","debugId":null}},
    {"offset": {"line": 53, "column": 0}, "map": {"version":3,"sources":["file:///Users/liyao/Code/workwork/frontend/Growth_OS/src/components/header/BrandLogo.tsx"],"sourcesContent":["import Image from 'next/image'\nimport { BRAND_LOGO_URL } from '@/lib/constants'\n\nexport function BrandLogo() {\n  return (\n    <button \n      onClick={() => window.location.href = '/'}\n      className=\"rounded-full px-2 py-1 h-10 flex items-center hover:opacity-80 transition-opacity cursor-pointer\" \n      style={{backgroundColor: '#16b4f2'}}\n    >\n      <Image \n        src={BRAND_LOGO_URL}\n        alt=\"GrowthOS Logo\" \n        width={160}\n        height={40}\n        className=\"h-10 w-auto object-contain rounded-lg\"\n        quality={100}\n        priority\n        unoptimized\n      />\n    </button>\n  )\n}"],"names":[],"mappings":";;;;AAAA;AACA;;;;AAEO,SAAS;IACd,qBACE,6LAAC;QACC,SAAS,IAAM,OAAO,QAAQ,CAAC,IAAI,GAAG;QACtC,WAAU;QACV,OAAO;YAAC,iBAAiB;QAAS;kBAElC,cAAA,6LAAC,gIAAA,CAAA,UAAK;YACJ,KAAK,0HAAA,CAAA,iBAAc;YACnB,KAAI;YACJ,OAAO;YACP,QAAQ;YACR,WAAU;YACV,SAAS;YACT,QAAQ;YACR,WAAW;;;;;;;;;;;AAInB;KAnBgB","debugId":null}},
    {"offset": {"line": 101, "column": 0}, "map": {"version":3,"sources":["file:///Users/liyao/Code/workwork/frontend/Growth_OS/src/components/auth/AuthModal.tsx"],"sourcesContent":["'use client'\n\nimport { useState } from 'react'\nimport { X, Mail, Lock, User, Eye, EyeOff } from 'lucide-react'\nimport { useAuth } from '@/providers/AuthProvider'\n\ninterface AuthModalProps {\n  isOpen: boolean\n  onClose: () => void\n  defaultMode?: 'signin' | 'signup'\n}\n\nexport function AuthModal({ isOpen, onClose, defaultMode = 'signin' }: AuthModalProps) {\n  const [mode, setMode] = useState(defaultMode)\n  const [email, setEmail] = useState('')\n  const [password, setPassword] = useState('')\n  const [username, setUsername] = useState('')\n  const [showPassword, setShowPassword] = useState(false)\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState('')\n\n  const { signIn, signUp } = useAuth()\n\n  if (!isOpen) return null\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault()\n    setLoading(true)\n    setError('')\n\n    try {\n      if (mode === 'signup') {\n        await signUp(email, password, username)\n      } else {\n        await signIn(email, password)\n      }\n      onClose()\n    } catch (err: unknown) {\n      setError(err instanceof Error ? err.message : 'An error occurred')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const switchMode = () => {\n    setMode(mode === 'signin' ? 'signup' : 'signin')\n    setError('')\n  }\n\n  return (\n    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n      <div className=\"bg-white rounded-xl max-w-md w-full p-6 relative\">\n        <button\n          onClick={onClose}\n          className=\"absolute top-4 right-4 text-gray-400 hover:text-gray-600\"\n        >\n          <X className=\"w-5 h-5\" />\n        </button>\n\n        <div className=\"text-center mb-6\">\n          <h2 className=\"text-2xl font-bold text-gray-900 mb-2\">\n            {mode === 'signin' ? 'Welcome Back!' : 'Join WorkWork'}\n          </h2>\n          <p className=\"text-gray-600\">\n            {mode === 'signin' \n              ? 'Sign in to access your dashboard' \n              : 'Create your account to get started'\n            }\n          </p>\n        </div>\n\n        {error && (\n          <div className=\"bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-lg mb-4 text-sm\">\n            {error}\n          </div>\n        )}\n\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n          {mode === 'signup' && (\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Username\n              </label>\n              <div className=\"relative\">\n                <User className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5\" />\n                <input\n                  type=\"text\"\n                  required\n                  value={username}\n                  onChange={(e) => setUsername(e.target.value)}\n                  className=\"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent\"\n                  placeholder=\"Your username\"\n                />\n              </div>\n            </div>\n          )}\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Email\n            </label>\n            <div className=\"relative\">\n              <Mail className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5\" />\n              <input\n                type=\"email\"\n                required\n                value={email}\n                onChange={(e) => setEmail(e.target.value)}\n                className=\"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent\"\n                placeholder=\"your@email.com\"\n              />\n            </div>\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Password\n            </label>\n            <div className=\"relative\">\n              <Lock className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5\" />\n              <input\n                type={showPassword ? 'text' : 'password'}\n                required\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n                className=\"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent\"\n                placeholder=\"Enter your password\"\n              />\n              <button\n                type=\"button\"\n                onClick={() => setShowPassword(!showPassword)}\n                className=\"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600\"\n              >\n                {showPassword ? <EyeOff className=\"w-5 h-5\" /> : <Eye className=\"w-5 h-5\" />}\n              </button>\n            </div>\n          </div>\n\n          <button\n            type=\"submit\"\n            disabled={loading}\n            className=\"w-full bg-primary text-white py-3 rounded-lg font-medium hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n          >\n            {loading ? 'Processing...' : (mode === 'signin' ? 'Sign In' : 'Create Account')}\n          </button>\n        </form>\n\n        <div className=\"mt-6 text-center\">\n          <p className=\"text-gray-600\">\n            {mode === 'signin' ? \"Don't have an account? \" : \"Already have an account? \"}\n            <button\n              onClick={switchMode}\n              className=\"text-primary hover:text-blue-600 font-medium\"\n            >\n              {mode === 'signin' ? 'Sign up' : 'Sign in'}\n            </button>\n          </p>\n        </div>\n\n        {mode === 'signin' && (\n          <div className=\"mt-4 text-center\">\n            <button className=\"text-sm text-gray-500 hover:text-gray-700\">\n              Forgot your password?\n            </button>\n          </div>\n        )}\n      </div>\n    </div>\n  )\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 449, "column": 0}, "map": {"version":3,"sources":["file:///Users/liyao/Code/workwork/frontend/Growth_OS/src/components/Header.tsx"],"sourcesContent":["'use client'\n\nimport { useState } from 'react'\nimport Image from 'next/image'\nimport { useRouter } from 'next/navigation'\nimport { User, LogOut, Settings, Package, ShoppingBag } from 'lucide-react'\nimport { BrandLogo } from './header/BrandLogo'\nimport { AuthModal } from './auth/AuthModal'\nimport { useAuth } from '@/providers/AuthProvider'\n\nexport function Header() {\n  const [showDropdown, setShowDropdown] = useState(false)\n  const [showAuthModal, setShowAuthModal] = useState(false)\n  const [authMode, setAuthMode] = useState<'signin' | 'signup'>('signin')\n  const router = useRouter()\n  \n  const { user, profile, signOut } = useAuth()\n\n  const handleAuthClick = (mode: 'signin' | 'signup') => {\n    setAuthMode(mode)\n    setShowAuthModal(true)\n  }\n\n  const handleSignOut = async () => {\n    await signOut()\n    setShowDropdown(false)\n  }\n\n  return (\n    <>\n      <div className=\"mx-6 mt-4 h-14 bg-primary flex items-center justify-between px-2 shadow-button rounded-full\">\n        <BrandLogo />\n        \n        <div className=\"flex items-center space-x-4\">\n          {user && profile ? (\n            // Authenticated user\n            <div className=\"relative\">\n              <button\n                onClick={() => setShowDropdown(!showDropdown)}\n                className=\"flex items-center space-x-2 bg-white hover:bg-gray-50 rounded-full px-3 py-2 transition-colors shadow-sm\"\n              >\n                <Image\n                  src={profile.avatar}\n                  alt={profile.username}\n                  width={32}\n                  height={32}\n                  className=\"w-8 h-8 rounded-full\"\n                />\n                <span className=\"text-gray-900 font-medium hidden sm:block\">\n                  {profile.username}\n                </span>\n              </button>\n\n              {showDropdown && (\n                <div className=\"absolute right-0 mt-2 w-72 bg-white rounded-lg shadow-lg py-2 z-50\">\n                  <div className=\"px-4 py-3 border-b border-gray-100 bg-white\">\n                    <p className=\"text-sm font-medium text-gray-900 truncate\">{profile.username}</p>\n                    <p className=\"text-xs text-gray-500 truncate\">\n                      {profile.walletAddress \n                        ? `${profile.walletAddress.slice(0, 6)}...${profile.walletAddress.slice(-4)}`\n                        : profile.email\n                      }\n                    </p>\n                  </div>\n                  \n                  <button\n                    onClick={() => {\n                      router.push('/profile')\n                      setShowDropdown(false)\n                    }}\n                    className=\"w-full flex items-center space-x-2 px-4 py-2 text-sm text-gray-700 hover:bg-gray-50\"\n                  >\n                    <User className=\"w-4 h-4\" />\n                    <span>Profile</span>\n                  </button>\n                  \n                  <button\n                    onClick={() => {\n                      router.push('/projects')\n                      setShowDropdown(false)\n                    }}\n                    className=\"w-full flex items-center space-x-2 px-4 py-2 text-sm text-gray-700 hover:bg-gray-50\"\n                  >\n                    <Package className=\"w-4 h-4\" />\n                    <span>My Projects</span>\n                  </button>\n                  \n                  <button\n                    onClick={() => {\n                      router.push('/orders')\n                      setShowDropdown(false)\n                    }}\n                    className=\"w-full flex items-center space-x-2 px-4 py-2 text-sm text-gray-700 hover:bg-gray-50\"\n                  >\n                    <ShoppingBag className=\"w-4 h-4\" />\n                    <span>My Orders</span>\n                  </button>\n                  \n                  <button\n                    onClick={() => {\n                      router.push('/settings')\n                      setShowDropdown(false)\n                    }}\n                    className=\"w-full flex items-center space-x-2 px-4 py-2 text-sm text-gray-700 hover:bg-gray-50\"\n                  >\n                    <Settings className=\"w-4 h-4\" />\n                    <span>Settings</span>\n                  </button>\n                  \n                  <div className=\"border-t border-gray-100 mt-2 pt-2\">\n                    <button\n                      onClick={handleSignOut}\n                      className=\"w-full flex items-center space-x-2 px-4 py-2 text-sm text-red-600 hover:bg-red-50\"\n                    >\n                      <LogOut className=\"w-4 h-4\" />\n                      <span>Sign Out</span>\n                    </button>\n                  </div>\n                </div>\n              )}\n            </div>\n          ) : (\n            // Unauthenticated user\n            <div className=\"flex items-center space-x-2\">\n              <button\n                onClick={() => handleAuthClick('signin')}\n                className=\"text-white hover:text-white/80 font-medium px-4 py-2 rounded-full hover:bg-white/10 transition-colors\"\n              >\n                Sign In\n              </button>\n              <button\n                onClick={() => handleAuthClick('signup')}\n                className=\"bg-white text-primary hover:bg-white/90 font-medium px-4 py-2 rounded-full transition-colors\"\n              >\n                Sign Up\n              </button>\n            </div>\n          )}\n        </div>\n      </div>\n\n      <AuthModal\n        isOpen={showAuthModal}\n        onClose={() => setShowAuthModal(false)}\n        defaultMode={authMode}\n      />\n    </>\n  )\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 781, "column": 0}, "map": {"version":3,"sources":["file:///Users/liyao/Code/workwork/frontend/Growth_OS/src/components/CategoryZones.tsx"],"sourcesContent":["'use client'\n\nimport { \n  GraduationCap, \n  Package, \n  Headphones, \n  Calendar, \n  Building2,\n  Grid3X3\n} from 'lucide-react'\nimport { ProductZone } from '@/types'\n\ninterface CategoryZonesProps {\n  activeZone?: ProductZone\n  onZoneChange?: (zone: ProductZone) => void\n}\n\nconst ZONE_CONFIG = [\n  {\n    key: 'all' as const,\n    label: 'All',\n    icon: Grid3X3,\n    description: 'Browse everything',\n    color: 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n  },\n  {\n    key: 'courses' as const,\n    label: 'Courses',\n    icon: GraduationCap,\n    description: 'Learn & develop skills',\n    color: 'bg-blue-100 text-blue-700 hover:bg-blue-200'\n  },\n  {\n    key: 'products' as const,\n    label: 'Products',\n    icon: Package,\n    description: 'Tools & templates',\n    color: 'bg-green-100 text-green-700 hover:bg-green-200'\n  },\n  {\n    key: 'services' as const,\n    label: 'Services',\n    icon: Headphones,\n    description: 'Professional help',\n    color: 'bg-purple-100 text-purple-700 hover:bg-purple-200'\n  },\n  {\n    key: 'events' as const,\n    label: 'Events',\n    icon: Calendar,\n    description: 'Conferences & meetups',\n    color: 'bg-orange-100 text-orange-700 hover:bg-orange-200'\n  },\n  {\n    key: 'accommodation' as const,\n    label: 'Accommodation',\n    icon: Building2,\n    description: 'Spaces & stays',\n    color: 'bg-indigo-100 text-indigo-700 hover:bg-indigo-200'\n  }\n]\n\nexport function CategoryZones({ activeZone = 'all', onZoneChange }: CategoryZonesProps) {\n  const handleZoneClick = (zone: ProductZone) => {\n    onZoneChange?.(zone)\n  }\n\n  return (\n    <div className=\"bg-white rounded-md p-1 shadow-button flex\">\n      {ZONE_CONFIG.map(({ key, label, icon: Icon }) => (\n        <button\n          key={key}\n          onClick={() => handleZoneClick(key)}\n          className={`\n            px-3 py-1 text-sm font-medium rounded transition-colors flex items-center gap-1.5\n            ${activeZone === key \n              ? 'bg-gray-200 text-text-primary' \n              : 'text-text-primary hover:bg-gray-100'\n            }\n          `}\n        >\n          <Icon className=\"w-3.5 h-3.5\" />\n          {label}\n        </button>\n      ))}\n    </div>\n  )\n}"],"names":[],"mappings":";;;;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAFA;;;AAiBA,MAAM,cAAc;IAClB;QACE,KAAK;QACL,OAAO;QACP,MAAM,+MAAA,CAAA,UAAO;QACb,aAAa;QACb,OAAO;IACT;IACA;QACE,KAAK;QACL,OAAO;QACP,MAAM,2NAAA,CAAA,gBAAa;QACnB,aAAa;QACb,OAAO;IACT;IACA;QACE,KAAK;QACL,OAAO;QACP,MAAM,2MAAA,CAAA,UAAO;QACb,aAAa;QACb,OAAO;IACT;IACA;QACE,KAAK;QACL,OAAO;QACP,MAAM,iNAAA,CAAA,aAAU;QAChB,aAAa;QACb,OAAO;IACT;IACA;QACE,KAAK;QACL,OAAO;QACP,MAAM,6MAAA,CAAA,WAAQ;QACd,aAAa;QACb,OAAO;IACT;IACA;QACE,KAAK;QACL,OAAO;QACP,MAAM,mNAAA,CAAA,YAAS;QACf,aAAa;QACb,OAAO;IACT;CACD;AAEM,SAAS,cAAc,KAAwD;QAAxD,EAAE,aAAa,KAAK,EAAE,YAAY,EAAsB,GAAxD;IAC5B,MAAM,kBAAkB,CAAC;QACvB,yBAAA,mCAAA,aAAe;IACjB;IAEA,qBACE,6LAAC;QAAI,WAAU;kBACZ,YAAY,GAAG,CAAC;gBAAC,EAAE,GAAG,EAAE,KAAK,EAAE,MAAM,IAAI,EAAE;iCAC1C,6LAAC;gBAEC,SAAS,IAAM,gBAAgB;gBAC/B,WAAW,AAAC,gHAKT,OAHC,eAAe,MACb,kCACA,uCACH;;kCAGH,6LAAC;wBAAK,WAAU;;;;;;oBACf;;eAXI;;;;;;;;;;;AAgBf;KAzBgB","debugId":null}},
    {"offset": {"line": 884, "column": 0}, "map": {"version":3,"sources":["file:///Users/liyao/Code/workwork/frontend/Growth_OS/src/components/ControlBar.tsx"],"sourcesContent":["'use client'\n\nimport { useState } from 'react'\nimport { FilterType, ProductZone } from '@/types'\nimport { FILTER_OPTIONS } from '@/lib/constants'\nimport { Search, X, Loader2 } from 'lucide-react'\nimport { CategoryZones } from './CategoryZones'\n\ninterface ControlBarProps {\n  onFilterChange?: (filter: FilterType) => void\n  onCreateProject?: () => void\n  onSearch?: (query: string) => void\n  activeFilter?: FilterType\n  isSearching?: boolean\n  // 新增专区相关props\n  activeZone?: ProductZone\n  onZoneChange?: (zone: ProductZone) => void\n}\n\nexport function ControlBar({ onFilterChange, onCreateProject, onSearch, activeFilter = 'time', isSearching = false, activeZone = 'all', onZoneChange }: ControlBarProps) {\n  const [searchQuery, setSearchQuery] = useState('')\n  const [isSearchFocused, setIsSearchFocused] = useState(false)\n\n  const handleFilterClick = (filter: FilterType) => {\n    onFilterChange?.(filter)\n  }\n\n  const handleSearchChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const query = e.target.value\n    setSearchQuery(query)\n    onSearch?.(query)\n  }\n\n  const clearSearch = () => {\n    setSearchQuery('')\n    onSearch?.('')\n  }\n\n  return (\n    <div className=\"pl-20 pr-20 py-3 flex items-center justify-between\">\n      {/* 左侧控件组 */}\n      <div className=\"flex items-center gap-4\">\n        <button \n          onClick={onCreateProject}\n          className=\"bg-primary text-text-inverse px-4 py-2 rounded-md text-md font-medium shadow-button hover:bg-blue-500 transition-colors\"\n        >\n          Create Project\n        </button>\n\n        {/* Search Box */}\n        <div className={`\n          relative flex items-center bg-white rounded-lg shadow-button transition-all duration-200\n          ${isSearchFocused ? 'ring-2 ring-primary ring-opacity-50' : ''}\n        `}>\n          {isSearching && searchQuery ? (\n            <Loader2 className=\"w-4 h-4 text-primary absolute left-3 animate-spin\" />\n          ) : (\n            <Search className=\"w-4 h-4 text-gray-400 absolute left-3\" />\n          )}\n          <input\n            type=\"text\"\n            value={searchQuery}\n            onChange={handleSearchChange}\n            onFocus={() => setIsSearchFocused(true)}\n            onBlur={() => setIsSearchFocused(false)}\n            placeholder=\"Search products, creators, or tags...\"\n            className=\"w-64 pl-10 pr-10 py-2 text-sm border-0 rounded-lg focus:outline-none focus:ring-0 bg-transparent text-text-primary placeholder-gray-400\"\n          />\n          {searchQuery && (\n            <button\n              onClick={clearSearch}\n              className=\"absolute right-3 text-gray-400 hover:text-gray-600 transition-colors\"\n            >\n              <X className=\"w-4 h-4\" />\n            </button>\n          )}\n        </div>\n\n        {/* Filter Options */}\n        <div className=\"bg-white rounded-md p-1 shadow-button flex\">\n          {FILTER_OPTIONS.map(({ key, label }) => (\n            <button\n              key={key}\n              onClick={() => handleFilterClick(key)}\n              className={`\n                px-3 py-1 text-sm font-medium rounded transition-colors\n                ${activeFilter === key \n                  ? 'bg-gray-200 text-text-primary' \n                  : 'text-text-primary hover:bg-gray-100'\n                }\n              `}\n            >\n              {label}\n            </button>\n          ))}\n        </div>\n      </div>\n\n      {/* 右侧专区选择器 */}\n      <CategoryZones\n        activeZone={activeZone}\n        onZoneChange={onZoneChange}\n      />\n    </div>\n  )\n}"],"names":[],"mappings":";;;;AAEA;AAEA;AACA;AAAA;AAAA;AACA;;;AANA;;;;;AAmBO,SAAS,WAAW,KAA4I;QAA5I,EAAE,cAAc,EAAE,eAAe,EAAE,QAAQ,EAAE,eAAe,MAAM,EAAE,cAAc,KAAK,EAAE,aAAa,KAAK,EAAE,YAAY,EAAmB,GAA5I;;IACzB,MAAM,CAAC,aAAa,eAAe,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAC/C,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAEvD,MAAM,oBAAoB,CAAC;QACzB,2BAAA,qCAAA,eAAiB;IACnB;IAEA,MAAM,qBAAqB,CAAC;QAC1B,MAAM,QAAQ,EAAE,MAAM,CAAC,KAAK;QAC5B,eAAe;QACf,qBAAA,+BAAA,SAAW;IACb;IAEA,MAAM,cAAc;QAClB,eAAe;QACf,qBAAA,+BAAA,SAAW;IACb;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BAEb,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBACC,SAAS;wBACT,WAAU;kCACX;;;;;;kCAKD,6LAAC;wBAAI,WAAW,AAAC,mHAEgD,OAA7D,kBAAkB,wCAAwC,IAAG;;4BAE9D,eAAe,4BACd,6LAAC,oNAAA,CAAA,UAAO;gCAAC,WAAU;;;;;qDAEnB,6LAAC,yMAAA,CAAA,SAAM;gCAAC,WAAU;;;;;;0CAEpB,6LAAC;gCACC,MAAK;gCACL,OAAO;gCACP,UAAU;gCACV,SAAS,IAAM,mBAAmB;gCAClC,QAAQ,IAAM,mBAAmB;gCACjC,aAAY;gCACZ,WAAU;;;;;;4BAEX,6BACC,6LAAC;gCACC,SAAS;gCACT,WAAU;0CAEV,cAAA,6LAAC,+LAAA,CAAA,IAAC;oCAAC,WAAU;;;;;;;;;;;;;;;;;kCAMnB,6LAAC;wBAAI,WAAU;kCACZ,0HAAA,CAAA,iBAAc,CAAC,GAAG,CAAC;gCAAC,EAAE,GAAG,EAAE,KAAK,EAAE;iDACjC,6LAAC;gCAEC,SAAS,IAAM,kBAAkB;gCACjC,WAAW,AAAC,8FAKT,OAHC,iBAAiB,MACf,kCACA,uCACH;0CAGF;+BAVI;;;;;;;;;;;;;;;;;0BAiBb,6LAAC,sIAAA,CAAA,gBAAa;gBACZ,YAAY;gBACZ,cAAc;;;;;;;;;;;;AAItB;GAtFgB;KAAA","debugId":null}},
    {"offset": {"line": 1036, "column": 0}, "map": {"version":3,"sources":["file:///Users/liyao/Code/workwork/frontend/Growth_OS/src/hooks/useModal.ts"],"sourcesContent":["import { useState, useEffect } from 'react'\n\nexport function useModal() {\n  const [isOpen, setIsOpen] = useState(false)\n  const [mounted, setMounted] = useState(false)\n\n  useEffect(() => {\n    setMounted(true)\n    return () => setMounted(false)\n  }, [])\n\n  const open = () => setIsOpen(true)\n  const close = () => setIsOpen(false)\n  const toggle = () => setIsOpen(prev => !prev)\n\n  return {\n    isOpen,\n    mounted,\n    open,\n    close,\n    toggle\n  }\n}"],"names":[],"mappings":";;;AAAA;;;AAEO,SAAS;;IACd,MAAM,CAAC,QAAQ,UAAU,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACrC,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAEvC,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;8BAAE;YACR,WAAW;YACX;sCAAO,IAAM,WAAW;;QAC1B;6BAAG,EAAE;IAEL,MAAM,OAAO,IAAM,UAAU;IAC7B,MAAM,QAAQ,IAAM,UAAU;IAC9B,MAAM,SAAS,IAAM,UAAU,CAAA,OAAQ,CAAC;IAExC,OAAO;QACL;QACA;QACA;QACA;QACA;IACF;AACF;GApBgB","debugId":null}},
    {"offset": {"line": 1075, "column": 0}, "map": {"version":3,"sources":["file:///Users/liyao/Code/workwork/frontend/Growth_OS/src/lib/streamflow.ts"],"sourcesContent":["import { supabase } from './supabase'\n\n// StreamFlow API配置\nconst STREAMFLOW_API_BASE = process.env.NODE_ENV === 'production' \n  ? 'https://api.streamflow.example.com' // 生产环境地址\n  : 'http://localhost:8080' // 开发环境地址，避免与Next.js端口冲突\n\n// 类型定义\nexport interface StreamFlowSeller {\n  id: string\n  walletAddress: string\n  name: string\n  email: string\n  description: string\n}\n\nexport interface StreamFlowStream {\n  id: string\n  streamId?: string\n  sellerId: string\n  buyerAddress: string\n  tokenMint: string\n  amount: string\n  amountPerPeriod: string\n  period: number\n  startTime: string\n  endTime: string\n  cliffTime?: string\n  cliffAmount?: string\n  canTopup?: boolean\n  cancelableBySender?: boolean\n  cancelableByRecipient?: boolean\n  transferableBySender?: boolean\n  transferableByRecipient?: boolean\n  automaticWithdrawal?: boolean\n  withdrawalFrequency?: number\n  orderId?: string\n  productName?: string\n  productType?: string\n  status: 'PENDING' | 'ACTIVE' | 'COMPLETED' | 'CANCELLED'\n  feeAmount: string\n  treasuryAddress: string\n}\n\nexport interface CreateStreamParams {\n  sellerId: string\n  buyerAddress: string\n  tokenMint: string\n  amount: string\n  amountPerPeriod: string\n  period: number\n  startTime: string\n  endTime: string\n  cliffTime?: string\n  cliffAmount?: string\n  canTopup?: boolean\n  cancelableBySender?: boolean\n  cancelableByRecipient?: boolean\n  transferableBySender?: boolean\n  transferableByRecipient?: boolean\n  automaticWithdrawal?: boolean\n  withdrawalFrequency?: number\n  orderId?: string\n  productName?: string\n  productType?: string\n}\n\n// API请求封装\nasync function streamflowRequest(endpoint: string, options: RequestInit = {}) {\n  // 在开发环境中使用模拟数据，避免调用不存在的API\n  if (process.env.NODE_ENV === 'development') {\n    console.log(`🔄 Mock StreamFlow API call: ${endpoint}`, options.body ? JSON.parse(options.body as string) : {})\n    \n    // 模拟API延迟\n    await new Promise(resolve => setTimeout(resolve, 500))\n    \n    // 根据不同的端点返回模拟数据\n    if (endpoint === '/api/sellers' && options.method === 'POST') {\n      return {\n        success: true,\n        data: {\n          id: `seller_${Date.now()}`,\n          walletAddress: 'mock_wallet_address',\n          name: 'Mock Seller',\n          email: 'seller@example.com',\n          description: 'Mock seller account'\n        }\n      }\n    }\n    \n    if (endpoint.includes('/api/streams') && options.method === 'POST') {\n      return {\n        success: true,\n        data: {\n          id: `stream_${Date.now()}`,\n          status: 'PENDING',\n          treasuryAddress: 'mock_treasury',\n          feeAmount: '0.1'\n        }\n      }\n    }\n    \n    if (endpoint.includes('/activate') && options.method === 'POST') {\n      return {\n        success: true,\n        data: { status: 'ACTIVE' }\n      }\n    }\n    \n    if (endpoint.includes('/cancel') && options.method === 'POST') {\n      return {\n        success: true,\n        data: { status: 'CANCELLED' }\n      }\n    }\n    \n    // 默认成功响应\n    return {\n      success: true,\n      data: {}\n    }\n  }\n  \n  // 生产环境的真实API调用\n  const url = `${STREAMFLOW_API_BASE}${endpoint}`\n  \n  const response = await fetch(url, {\n    headers: {\n      'Content-Type': 'application/json',\n      ...options.headers,\n    },\n    ...options,\n  })\n\n  if (!response.ok) {\n    const errorText = await response.text()\n    throw new Error(`StreamFlow API Error (${response.status}): ${errorText}`)\n  }\n\n  return response.json()\n}\n\nexport class StreamFlowService {\n  // 创建卖家账户\n  static async createSeller(params: {\n    walletAddress: string\n    name: string\n    email: string\n    description: string\n  }): Promise<StreamFlowSeller> {\n    try {\n      const response = await streamflowRequest('/api/sellers', {\n        method: 'POST',\n        body: JSON.stringify(params),\n      })\n\n      if (!response.success) {\n        throw new Error(response.error || 'Failed to create seller')\n      }\n\n      return response.data\n    } catch (error) {\n      console.error('StreamFlow createSeller error:', error)\n      throw error\n    }\n  }\n\n  // 获取或创建卖家（确保用户有StreamFlow账户）\n  static async ensureSeller(userId: string): Promise<string> {\n    if (!supabase) {\n      throw new Error('Supabase not available')\n    }\n\n    try {\n      // 检查是否已存在StreamFlow卖家记录\n      const { data: existingSeller } = await supabase\n        .from('streamflow_sellers')\n        .select('streamflow_seller_id')\n        .eq('user_id', userId)\n        .single()\n\n      if (existingSeller) {\n        return existingSeller.streamflow_seller_id\n      }\n\n      // 获取用户信息\n      const { data: userProfile } = await supabase\n        .from('users')\n        .select('username, email, bio, wallet_address')\n        .eq('id', userId)\n        .single()\n\n      if (!userProfile) {\n        throw new Error('User profile not found')\n      }\n\n      if (!userProfile.wallet_address) {\n        throw new Error('User must have an Ethereum wallet address to become a seller')\n      }\n\n      // 创建StreamFlow卖家账户\n      const streamflowSeller = await this.createSeller({\n        walletAddress: userProfile.wallet_address,\n        name: userProfile.username || 'Anonymous Seller',\n        email: userProfile.email || '',\n        description: userProfile.bio || 'WorkWork seller'\n      })\n\n      // 保存映射关系\n      const { error: insertError } = await supabase\n        .from('streamflow_sellers')\n        .insert({\n          user_id: userId,\n          streamflow_seller_id: streamflowSeller.id,\n          wallet_address: userProfile.wallet_address,\n          name: userProfile.username,\n          email: userProfile.email,\n          description: userProfile.bio\n        })\n\n      if (insertError) {\n        console.error('Failed to save streamflow seller mapping:', insertError)\n        // 如果保存失败，仍然返回sellerId，下次会重试\n      }\n\n      return streamflowSeller.id\n    } catch (error) {\n      console.error('StreamFlow ensureSeller error:', error)\n      throw error\n    }\n  }\n\n  // 创建流支付\n  static async createStream(params: CreateStreamParams): Promise<StreamFlowStream> {\n    try {\n      const response = await streamflowRequest('/api/streams', {\n        method: 'POST',\n        body: JSON.stringify(params),\n      })\n\n      if (!response.success) {\n        throw new Error(response.error || 'Failed to create stream')\n      }\n\n      return response.data\n    } catch (error) {\n      console.error('StreamFlow createStream error:', error)\n      throw error\n    }\n  }\n\n  // 激活流支付\n  static async activateStream(streamId: string): Promise<{\n    streamId: string\n    transactionId: string\n    derivedWalletAddress: string\n    feeAmount: string\n    finalAmount: string\n  }> {\n    try {\n      const response = await streamflowRequest(`/api/streams/${streamId}/activate`, {\n        method: 'POST',\n      })\n\n      if (!response.success) {\n        throw new Error(response.error || 'Failed to activate stream')\n      }\n\n      return response.data\n    } catch (error) {\n      console.error('StreamFlow activateStream error:', error)\n      throw error\n    }\n  }\n\n  // 获取流支付详情\n  static async getStream(streamId: string): Promise<StreamFlowStream> {\n    try {\n      const response = await streamflowRequest(`/api/streams/${streamId}`)\n\n      if (!response.success) {\n        throw new Error(response.error || 'Failed to get stream')\n      }\n\n      return response.data\n    } catch (error) {\n      console.error('StreamFlow getStream error:', error)\n      throw error\n    }\n  }\n\n  // 取消流支付\n  static async cancelStream(streamId: string): Promise<void> {\n    try {\n      const response = await streamflowRequest(`/api/streams/${streamId}/cancel`, {\n        method: 'POST',\n      })\n\n      if (!response.success) {\n        throw new Error(response.error || 'Failed to cancel stream')\n      }\n    } catch (error) {\n      console.error('StreamFlow cancelStream error:', error)\n      throw error\n    }\n  }\n\n  // 获取卖家的所有流支付\n  static async getSellerStreams(sellerId: string): Promise<StreamFlowStream[]> {\n    try {\n      const response = await streamflowRequest(`/api/streams/seller/${sellerId}`)\n\n      if (!response.success) {\n        throw new Error(response.error || 'Failed to get seller streams')\n      }\n\n      return response.data\n    } catch (error) {\n      console.error('StreamFlow getSellerStreams error:', error)\n      throw error\n    }\n  }\n\n  // 获取买家的所有流支付\n  static async getBuyerStreams(buyerAddress: string): Promise<StreamFlowStream[]> {\n    try {\n      const response = await streamflowRequest(`/api/streams/buyer/${buyerAddress}`)\n\n      if (!response.success) {\n        throw new Error(response.error || 'Failed to get buyer streams')\n      }\n\n      return response.data\n    } catch (error) {\n      console.error('StreamFlow getBuyerStreams error:', error)\n      throw error\n    }\n  }\n}\n\n// 工具函数\nexport class StreamFlowUtils {\n  // SOL转换为lamports\n  static solToLamports(sol: number): string {\n    return (sol * 1_000_000_000).toString()\n  }\n\n  // lamports转换为SOL\n  static lamportsToSol(lamports: string): number {\n    return parseInt(lamports) / 1_000_000_000\n  }\n\n  // 计算订阅参数\n  static calculateSubscriptionParams(\n    type: 'product' | 'subscription',\n    price: number,\n    subscriptionPeriod?: 'monthly' | 'quarterly' | 'yearly',\n    subscriptionDuration?: number\n  ) {\n    const now = new Date()\n    const startTime = new Date(now.getTime() + 5 * 60 * 1000) // 5分钟后开始\n    \n    if (type === 'product') {\n      // 一次性商品：立即释放全部金额\n      return {\n        amount: this.solToLamports(price),\n        amountPerPeriod: this.solToLamports(price),\n        period: 1, // 1秒\n        startTime: startTime.toISOString(),\n        endTime: new Date(startTime.getTime() + 1000).toISOString(), // 开始后1秒结束\n        automaticWithdrawal: true,\n        cancelableBySender: false,\n        cancelableByRecipient: false\n      }\n    } else {\n      // 订阅服务：按周期释放\n      if (!subscriptionPeriod || !subscriptionDuration) {\n        throw new Error('Subscription period and duration are required for subscription products')\n      }\n\n      const periodSeconds = {\n        monthly: 30 * 24 * 60 * 60, // 30天\n        quarterly: 90 * 24 * 60 * 60, // 90天  \n        yearly: 365 * 24 * 60 * 60 // 365天\n      }[subscriptionPeriod]\n\n      const totalPeriods = subscriptionDuration / ({\n        monthly: 1,\n        quarterly: 3,\n        yearly: 12\n      }[subscriptionPeriod])\n\n      const totalAmount = price * totalPeriods\n      const endTime = new Date(startTime.getTime() + subscriptionDuration * 30 * 24 * 60 * 60 * 1000)\n\n      return {\n        amount: this.solToLamports(totalAmount),\n        amountPerPeriod: this.solToLamports(price),\n        period: periodSeconds,\n        startTime: startTime.toISOString(),\n        endTime: endTime.toISOString(),\n        automaticWithdrawal: true,\n        cancelableBySender: true,\n        cancelableByRecipient: true\n      }\n    }\n  }\n\n  // 验证用户支付条件\n  static async validatePaymentConditions(userId: string): Promise<{\n    canPay: boolean\n    hasWallet: boolean\n    hasPaymentMethod: boolean\n    missingRequirements: string[]\n  }> {\n    if (!supabase) {\n      throw new Error('Supabase not available')\n    }\n\n    try {\n      const { data: user } = await supabase\n        .from('users')\n        .select('wallet_address, social_wechat, social_alipay')\n        .eq('id', userId)\n        .single()\n\n      if (!user) {\n        throw new Error('User not found')\n      }\n\n      const hasWallet = !!user.wallet_address\n      const hasPaymentMethod = !!(user.social_wechat || user.social_alipay)\n      const canPay = hasWallet || hasPaymentMethod\n\n      const missingRequirements = []\n      if (!hasWallet) missingRequirements.push('Ethereum wallet')\n      if (!hasPaymentMethod) missingRequirements.push('WeChat or Alipay')\n\n      return {\n        canPay,\n        hasWallet,\n        hasPaymentMethod,\n        missingRequirements: canPay ? [] : missingRequirements\n      }\n    } catch (error) {\n      console.error('Error validating payment conditions:', error)\n      throw error\n    }\n  }\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1385, "column": 0}, "map": {"version":3,"sources":["file:///Users/liyao/Code/workwork/frontend/Growth_OS/src/lib/orders.ts"],"sourcesContent":["import { supabase } from './supabase'\nimport { StreamFlowService, StreamFlowUtils } from './streamflow'\n\n// 类型定义\nexport interface Order {\n  id: string\n  product_id: string\n  buyer_id: string\n  seller_id: string\n  total_amount: number\n  currency: string\n  streamflow_stream_id?: string\n  streamflow_seller_id?: string\n  buyer_wallet_address?: string\n  seller_wallet_address?: string\n  status: 'pending' | 'processing' | 'active' | 'completed' | 'cancelled' | 'failed'\n  product_type: 'product' | 'subscription'\n  subscription_period?: 'monthly' | 'quarterly' | 'yearly'\n  subscription_duration?: number\n  subscription_start_date?: string\n  subscription_end_date?: string\n  stream_amount?: string\n  stream_amount_per_period?: string\n  stream_period_seconds?: number\n  stream_start_time?: string\n  stream_end_time?: string\n  error_message?: string\n  retry_count: number\n  last_retry_at?: string\n  created_at: string\n  updated_at: string\n}\n\nexport interface OrderWithProduct extends Order {\n  product: {\n    id: string\n    name: string\n    description: string\n    price: number\n    currency: string\n    images?: Array<{ url: string; alt: string }>\n    image_url?: string // 计算得出的向后兼容字段\n    author_name: string\n  }\n  buyer: {\n    id: string\n    username: string\n    email: string\n  }\n  seller: {\n    id: string\n    username: string\n    email: string\n  }\n}\n\nexport interface CreateOrderParams {\n  productId: string\n  buyerId: string\n  buyerWalletAddress?: string\n}\n\nexport class OrdersService {\n  // 创建订单\n  static async createOrder(params: CreateOrderParams): Promise<Order> {\n    if (!supabase) {\n      throw new Error('Supabase not available')\n    }\n\n    try {\n      // 获取产品信息\n      const { data: product, error: productError } = await supabase\n        .from('products')\n        .select('*')\n        .eq('id', params.productId)\n        .eq('status', 'active')\n        .single()\n\n      if (productError || !product) {\n        throw new Error('Product not found or inactive')\n      }\n\n      // 获取买家信息\n      const { data: buyer, error: buyerError } = await supabase\n        .from('users')\n        .select('wallet_address')\n        .eq('id', params.buyerId)\n        .single()\n\n      if (buyerError || !buyer) {\n        throw new Error('Buyer not found')\n      }\n\n      // 获取卖家信息\n      const { data: seller, error: sellerError } = await supabase\n        .from('users')\n        .select('wallet_address')\n        .eq('id', product.author_id)\n        .single()\n\n      if (sellerError || !seller) {\n        throw new Error('Seller not found')\n      }\n\n      // 验证支付条件\n      const paymentValidation = await StreamFlowUtils.validatePaymentConditions(params.buyerId)\n      if (!paymentValidation.canPay) {\n        throw new Error(`Payment requirements not met. Please bind: ${paymentValidation.missingRequirements.join(' or ')}`)\n      }\n\n      // 计算订阅参数\n      const streamParams = StreamFlowUtils.calculateSubscriptionParams(\n        product.product_type,\n        product.price,\n        product.subscription_period,\n        product.subscription_duration\n      )\n\n      // 创建订单记录\n      const orderData = {\n        product_id: params.productId,\n        buyer_id: params.buyerId,\n        seller_id: product.author_id,\n        total_amount: product.price,\n        currency: product.currency,\n        buyer_wallet_address: params.buyerWalletAddress || buyer.wallet_address,\n        seller_wallet_address: seller.wallet_address,\n        status: 'pending' as const,\n        product_type: product.product_type,\n        subscription_period: product.subscription_period,\n        subscription_duration: product.subscription_duration,\n        subscription_start_date: product.product_type === 'subscription' ? streamParams.startTime : null,\n        subscription_end_date: product.product_type === 'subscription' ? streamParams.endTime : null,\n        stream_amount: streamParams.amount,\n        stream_amount_per_period: streamParams.amountPerPeriod,\n        stream_period_seconds: streamParams.period,\n        stream_start_time: streamParams.startTime,\n        stream_end_time: streamParams.endTime,\n        retry_count: 0\n      }\n\n      const { data: order, error: orderError } = await supabase\n        .from('orders')\n        .insert(orderData)\n        .select()\n        .single()\n\n      if (orderError) {\n        throw new Error(`Failed to create order: ${orderError.message}`)\n      }\n\n      return order\n    } catch (error) {\n      console.error('OrdersService createOrder error:', error)\n      throw error\n    }\n  }\n\n  // 处理订单支付（对接StreamFlow）\n  static async processPayment(orderId: string): Promise<Order> {\n    if (!supabase) {\n      throw new Error('Supabase not available')\n    }\n\n    try {\n      // 获取订单信息\n      const { data: order, error: orderError } = await supabase\n        .from('orders')\n        .select('*')\n        .eq('id', orderId)\n        .single()\n\n      if (orderError || !order) {\n        throw new Error('Order not found')\n      }\n\n      if (order.status !== 'pending') {\n        throw new Error(`Order status is ${order.status}, cannot process payment`)\n      }\n\n      // 更新订单状态为处理中\n      await supabase\n        .from('orders')\n        .update({ \n          status: 'processing',\n          retry_count: order.retry_count + 1,\n          last_retry_at: new Date().toISOString()\n        })\n        .eq('id', orderId)\n\n      try {\n        // 确保卖家在StreamFlow中存在\n        const streamflowSellerId = await StreamFlowService.ensureSeller(order.seller_id)\n\n        // 创建StreamFlow流支付\n        const stream = await StreamFlowService.createStream({\n          sellerId: streamflowSellerId,\n          buyerAddress: order.buyer_wallet_address || 'BUYER_PLACEHOLDER',\n          tokenMint: 'So11111111111111111111111111111111111111112', // SOL\n          amount: order.stream_amount!,\n          amountPerPeriod: order.stream_amount_per_period!,\n          period: order.stream_period_seconds!,\n          startTime: order.stream_start_time!,\n          endTime: order.stream_end_time!,\n          automaticWithdrawal: true,\n          cancelableBySender: order.product_type === 'subscription',\n          cancelableByRecipient: order.product_type === 'subscription',\n          orderId: order.id,\n          productName: `WorkWork Order ${order.id}`,\n          productType: order.product_type\n        })\n\n        // 激活流支付\n        await StreamFlowService.activateStream(stream.id)\n\n        // 更新订单信息\n        const { data: updatedOrder, error: updateError } = await supabase\n          .from('orders')\n          .update({\n            status: 'active',\n            streamflow_stream_id: stream.id,\n            streamflow_seller_id: streamflowSellerId,\n            error_message: null\n          })\n          .eq('id', orderId)\n          .select()\n          .single()\n\n        if (updateError) {\n          throw new Error(`Failed to update order: ${updateError.message}`)\n        }\n\n        return updatedOrder\n      } catch (streamflowError) {\n        // StreamFlow操作失败，更新订单状态\n        await supabase\n          .from('orders')\n          .update({\n            status: 'failed',\n            error_message: streamflowError instanceof Error ? streamflowError.message : 'Unknown error'\n          })\n          .eq('id', orderId)\n\n        throw streamflowError\n      }\n    } catch (error) {\n      console.error('OrdersService processPayment error:', error)\n      throw error\n    }\n  }\n\n  // 取消订单\n  static async cancelOrder(orderId: string, userId: string): Promise<void> {\n    if (!supabase) {\n      throw new Error('Supabase not available')\n    }\n\n    try {\n      // 获取订单信息\n      const { data: order, error: orderError } = await supabase\n        .from('orders')\n        .select('*')\n        .eq('id', orderId)\n        .or(`buyer_id.eq.${userId},seller_id.eq.${userId}`)\n        .single()\n\n      if (orderError || !order) {\n        throw new Error('Order not found or access denied')\n      }\n\n      if (['completed', 'cancelled'].includes(order.status)) {\n        throw new Error(`Order is already ${order.status}`)\n      }\n\n      // 如果有StreamFlow流支付，先取消它\n      if (order.streamflow_stream_id && order.status === 'active') {\n        try {\n          await StreamFlowService.cancelStream(order.streamflow_stream_id)\n        } catch (error) {\n          console.error('Failed to cancel StreamFlow stream:', error)\n          // 继续取消本地订单，即使StreamFlow取消失败\n        }\n      }\n\n      // 更新订单状态\n      await supabase\n        .from('orders')\n        .update({ status: 'cancelled' })\n        .eq('id', orderId)\n    } catch (error) {\n      console.error('OrdersService cancelOrder error:', error)\n      throw error\n    }\n  }\n\n  // 获取用户订单列表\n  static async getUserOrders(\n    userId: string, \n    role: 'buyer' | 'seller' = 'buyer',\n    limit: number = 20,\n    offset: number = 0\n  ): Promise<OrderWithProduct[]> {\n    if (!supabase) {\n      throw new Error('Supabase not available')\n    }\n\n    try {\n      const userIdField = role === 'buyer' ? 'buyer_id' : 'seller_id'\n      \n      const { data: orders, error } = await supabase\n        .from('orders')\n        .select(`\n          *,\n          product:products!inner (\n            id, name, description, price, currency, images, author_name\n          ),\n          buyer:users!orders_buyer_id_fkey (\n            id, username, email\n          ),\n          seller:users!orders_seller_id_fkey (\n            id, username, email\n          )\n        `)\n        .eq(userIdField, userId)\n        .order('created_at', { ascending: false })\n        .range(offset, offset + limit - 1)\n\n      if (error) {\n        throw new Error(`Failed to fetch orders: ${error.message}`)\n      }\n\n      // 转换数据并添加向后兼容的 image_url 字段\n      const transformedOrders = (orders || []).map(order => ({\n        ...order,\n        product: {\n          ...order.product,\n          image_url: order.product.images && order.product.images.length > 0 \n            ? order.product.images[0].url \n            : 'https://avatars.githubusercontent.com/u/190834534?s=200&v=4'\n        }\n      }))\n\n      return transformedOrders\n    } catch (error) {\n      console.error('OrdersService getUserOrders error:', error)\n      throw error\n    }\n  }\n\n  // 获取订单详情\n  static async getOrderById(orderId: string, userId: string): Promise<OrderWithProduct> {\n    if (!supabase) {\n      throw new Error('Supabase not available')\n    }\n\n    try {\n      const { data: order, error } = await supabase\n        .from('orders')\n        .select(`\n          *,\n          product:products!inner (\n            id, name, description, price, currency, images, author_name\n          ),\n          buyer:users!orders_buyer_id_fkey (\n            id, username, email\n          ),\n          seller:users!orders_seller_id_fkey (\n            id, username, email\n          )\n        `)\n        .eq('id', orderId)\n        .or(`buyer_id.eq.${userId},seller_id.eq.${userId}`)\n        .single()\n\n      if (error || !order) {\n        throw new Error('Order not found or access denied')\n      }\n\n      // 转换数据并添加向后兼容的 image_url 字段\n      const transformedOrder = {\n        ...order,\n        product: {\n          ...order.product,\n          image_url: order.product.images && order.product.images.length > 0 \n            ? order.product.images[0].url \n            : 'https://avatars.githubusercontent.com/u/190834534?s=200&v=4'\n        }\n      }\n\n      return transformedOrder\n    } catch (error) {\n      console.error('OrdersService getOrderById error:', error)\n      throw error\n    }\n  }\n\n  // 重试失败的订单\n  static async retryOrder(orderId: string, userId: string): Promise<Order> {\n    if (!supabase) {\n      throw new Error('Supabase not available')\n    }\n\n    try {\n      // 获取订单信息\n      const { data: order, error: orderError } = await supabase\n        .from('orders')\n        .select('*')\n        .eq('id', orderId)\n        .eq('buyer_id', userId) // 只允许买家重试\n        .single()\n\n      if (orderError || !order) {\n        throw new Error('Order not found or access denied')\n      }\n\n      if (order.status !== 'failed') {\n        throw new Error('Only failed orders can be retried')\n      }\n\n      if (order.retry_count >= 3) {\n        throw new Error('Maximum retry attempts reached')\n      }\n\n      // 重置订单状态为pending并处理支付\n      await supabase\n        .from('orders')\n        .update({ \n          status: 'pending',\n          error_message: null\n        })\n        .eq('id', orderId)\n\n      return await this.processPayment(orderId)\n    } catch (error) {\n      console.error('OrdersService retryOrder error:', error)\n      throw error\n    }\n  }\n\n  // 获取订单统计\n  static async getOrderStats(userId: string, role: 'buyer' | 'seller' = 'buyer'): Promise<{\n    total: number\n    pending: number\n    active: number\n    completed: number\n    cancelled: number\n    failed: number\n  }> {\n    if (!supabase) {\n      throw new Error('Supabase not available')\n    }\n\n    try {\n      const userIdField = role === 'buyer' ? 'buyer_id' : 'seller_id'\n      \n      const { data: orders, error } = await supabase\n        .from('orders')\n        .select('status')\n        .eq(userIdField, userId)\n\n      if (error) {\n        throw new Error(`Failed to fetch order stats: ${error.message}`)\n      }\n\n      const stats = {\n        total: orders?.length || 0,\n        pending: 0,\n        active: 0,\n        completed: 0,\n        cancelled: 0,\n        failed: 0\n      }\n\n      orders?.forEach(order => {\n        if (order.status in stats) {\n          stats[order.status as keyof typeof stats]++\n        }\n      })\n\n      return stats\n    } catch (error) {\n      console.error('OrdersService getOrderStats error:', error)\n      throw error\n    }\n  }\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1676, "column": 0}, "map": {"version":3,"sources":["file:///Users/liyao/Code/workwork/frontend/Growth_OS/src/components/PurchaseConfirmModal.tsx"],"sourcesContent":["'use client'\n\nimport { createPortal } from 'react-dom'\nimport { useState, useEffect, useCallback } from 'react'\nimport { Project } from '@/types'\nimport { useAuth } from '@/providers/AuthProvider'\nimport { OrdersService } from '@/lib/orders'\nimport { StreamFlowUtils } from '@/lib/streamflow'\nimport { supabase } from '@/lib/supabase'\nimport { \n  ShoppingCart, \n  MessageCircle, \n  CreditCard, \n  Building, \n  DollarSign, \n  AlertCircle, \n  CheckCircle,\n  Loader2,\n  Calendar,\n  Repeat\n} from 'lucide-react'\n\ninterface PurchaseConfirmModalProps {\n  project: Project\n  isOpen: boolean\n  onClose: () => void\n  mounted: boolean\n}\n\ntype PaymentMethod = 'solana' | 'wechat' | 'alipay' | 'card'\ntype PurchaseStep = 'select-method' | 'confirm-details' | 'sablier-payment' | 'processing' | 'success' | 'error'\n\nexport function PurchaseConfirmModal({ project, isOpen, onClose, mounted }: PurchaseConfirmModalProps) {\n  const { user, profile } = useAuth()\n  const [step, setStep] = useState<PurchaseStep>('select-method')\n  const [selectedMethod, setSelectedMethod] = useState<PaymentMethod | null>(null)\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState<string | null>(null)\n  const [orderId, setOrderId] = useState<string | null>(null)\n  const [sellerWalletAddress, setSellerWalletAddress] = useState<string | null>(null)\n  const [paymentConditions, setPaymentConditions] = useState<{\n    canPay: boolean\n    hasWallet: boolean\n    hasPaymentMethod: boolean\n    missingRequirements: string[]\n  } | null>(null)\n\n  const fetchSellerWalletAddress = useCallback(async () => {\n    if (!project.author_id || !supabase) return\n    \n    try {\n      const { data: seller, error } = await supabase\n        .from('users')\n        .select('wallet_address')\n        .eq('id', project.author_id)\n        .single()\n        \n      if (error) {\n        console.error('Failed to fetch seller wallet address:', error)\n        return\n      }\n      \n      setSellerWalletAddress(seller?.wallet_address || null)\n    } catch (error) {\n      console.error('Error fetching seller wallet address:', error)\n    }\n  }, [project.author_id])\n\n  const checkPaymentConditions = useCallback(async () => {\n    if (!user) return\n    \n    try {\n      const conditions = await StreamFlowUtils.validatePaymentConditions(user.id)\n      setPaymentConditions(conditions)\n      \n      if (!conditions.canPay) {\n        setError(`Payment requirements not met. Please bind: ${conditions.missingRequirements.join(' or ')}`)\n      }\n    } catch (error) {\n      console.error('Failed to check payment conditions:', error)\n      setError('Failed to check payment conditions')\n    }\n  }, [user])\n\n  // 检查支付条件并获取卖家钱包地址\n  useEffect(() => {\n    if (isOpen && user) {\n      checkPaymentConditions()\n      fetchSellerWalletAddress()\n    }\n  }, [isOpen, user, checkPaymentConditions, fetchSellerWalletAddress])\n\n  const handleMethodSelect = (method: PaymentMethod) => {\n    setSelectedMethod(method)\n    setError(null)\n    \n    // 验证选择的支付方式是否可用\n    if (method === 'solana' && !paymentConditions?.hasWallet) {\n      setError('Please bind an Ethereum wallet to use crypto payment')\n      return\n    }\n    \n    if (['wechat', 'alipay', 'card'].includes(method) && !paymentConditions?.hasPaymentMethod) {\n      setError('Please bind WeChat, Alipay or credit card to use traditional payment')\n      return\n    }\n    \n    setStep('confirm-details')\n  }\n\n  const handleConfirmPurchase = async () => {\n    if (!user || !selectedMethod) return\n    \n    // 如果选择的是加密支付，直接跳转到 Sablier iframe\n    if (selectedMethod === 'solana') {\n      setStep('sablier-payment')\n      return\n    }\n    \n    // 其他支付方式的原有逻辑\n    setLoading(true)\n    setError(null)\n    setStep('processing')\n    \n    try {\n      // 创建订单\n      const order = await OrdersService.createOrder({\n        productId: project.id,\n        buyerId: user.id,\n        buyerWalletAddress: undefined\n      })\n      \n      setOrderId(order.id)\n      \n      // 处理支付\n      const processedOrder = await OrdersService.processPayment(order.id)\n      \n      if (processedOrder.status === 'active') {\n        setStep('success')\n      } else {\n        throw new Error('Payment processing failed')\n      }\n    } catch (error) {\n      console.error('Purchase error:', error)\n      setError(error instanceof Error ? error.message : 'Purchase failed')\n      setStep('error')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const handleRetry = async () => {\n    if (!orderId || !user) return\n    \n    setLoading(true)\n    setError(null)\n    setStep('processing')\n    \n    try {\n      const processedOrder = await OrdersService.retryOrder(orderId, user.id)\n      \n      if (processedOrder.status === 'active') {\n        setStep('success')\n      } else {\n        throw new Error('Payment retry failed')\n      }\n    } catch (error) {\n      console.error('Retry error:', error)\n      setError(error instanceof Error ? error.message : 'Retry failed')\n      setStep('error')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const resetModal = () => {\n    setStep('select-method')\n    setSelectedMethod(null)\n    setError(null)\n    setOrderId(null)\n    setSellerWalletAddress(null)\n    setLoading(false)\n  }\n\n  const handleClose = () => {\n    resetModal()\n    onClose()\n  }\n\n  if (!isOpen || !mounted) return null\n\n  const isSubscription = project.product_type === 'subscription'\n  const totalAmount = isSubscription \n    ? (project.subscription_price_per_period || project.price) * (project.subscription_duration || 1)\n    : project.price\n\n  const modalContent = (\n    <div \n      className=\"fixed inset-0 backdrop-blur-sm bg-white/20 flex items-center justify-center z-50 animate-fadeIn\" \n      onClick={handleClose}\n    >\n      <div \n        className=\"bg-white rounded-lg max-w-lg w-full max-h-[80vh] overflow-y-auto m-4 animate-slideUpAndScale\" \n        onClick={(e) => e.stopPropagation()}\n      >\n        {/* Header */}\n        <div className=\"sticky top-0 bg-white border-b p-4 flex items-center justify-between\">\n          <h2 className=\"text-xl font-bold text-text-primary\">\n            {step === 'select-method' && 'Choose Payment Method'}\n            {step === 'confirm-details' && 'Confirm Purchase'}\n            {step === 'sablier-payment' && 'Complete Payment'}\n            {step === 'processing' && 'Processing Payment'}\n            {step === 'success' && 'Purchase Successful'}\n            {step === 'error' && 'Payment Failed'}\n          </h2>\n          <button \n            onClick={handleClose}\n            className=\"text-gray-400 hover:text-gray-600 text-2xl font-light\"\n          >\n            ×\n          </button>\n        </div>\n\n        <div className=\"p-6\">\n          {/* Product Summary */}\n          <div className=\"mb-6 p-4 bg-gray-50 rounded-lg\">\n            <div className=\"flex gap-4\">\n              <div \n                className=\"w-20 h-20 rounded-lg bg-cover bg-center flex-shrink-0\"\n                style={{\n                  backgroundImage: `url(${project.image || project.image_url || '/project-image.png'})`\n                }}\n              />\n              <div className=\"flex-1\">\n                <h3 className=\"font-semibold text-gray-800 mb-1\">{project.name}</h3>\n                <p className=\"text-sm text-gray-600 mb-2\">by {project.author}</p>\n                \n                {/* Product Type Badge */}\n                <div className=\"flex items-center gap-2 mb-2\">\n                  {isSubscription ? (\n                    <span className=\"inline-flex items-center px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full\">\n                      <Repeat className=\"w-3 h-3 mr-1\" />\n                      Subscription\n                    </span>\n                  ) : (\n                    <span className=\"inline-flex items-center px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full\">\n                      <ShoppingCart className=\"w-3 h-3 mr-1\" />\n                      One-time Purchase\n                    </span>\n                  )}\n                </div>\n\n                {/* Pricing */}\n                <div className=\"text-lg font-bold text-primary\">\n                  {isSubscription ? (\n                    <div>\n                      <div>{((project.subscription_price_per_period || project.price) / 100).toFixed(3)} ETH/{project.subscription_period}</div>\n                      <div className=\"text-sm font-normal text-gray-600\">\n                        Total: {(totalAmount / 100).toFixed(3)} ETH for {project.subscription_duration} {project.subscription_period}(s)\n                      </div>\n                    </div>\n                  ) : (\n                    <div>{(project.price / 100).toFixed(3)} ETH</div>\n                  )}\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* Payment Requirements Check */}\n          {paymentConditions && !paymentConditions.canPay && (\n            <div className=\"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg\">\n              <div className=\"flex items-start gap-3\">\n                <AlertCircle className=\"w-5 h-5 text-red-600 mt-0.5 flex-shrink-0\" />\n                <div>\n                  <p className=\"text-red-800 font-medium\">Payment Requirements Not Met</p>\n                  <p className=\"text-red-700 text-sm mt-1\">\n                    Please bind at least one payment method: {paymentConditions.missingRequirements.join(' or ')}\n                  </p>\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* Step Content */}\n          {step === 'select-method' && paymentConditions?.canPay && (\n            <div>\n              <h4 className=\"text-lg font-semibold text-gray-800 mb-4\">Select Payment Method</h4>\n              <div className=\"grid grid-cols-1 gap-3\">\n                {/* Solana Payment */}\n                {paymentConditions?.hasWallet && (\n                  <button \n                    className=\"p-4 border border-gray-200 rounded-lg hover:border-orange-400 hover:bg-orange-50 transition-colors flex items-center gap-3 text-left\"\n                    onClick={() => handleMethodSelect('solana')}\n                  >\n                    <DollarSign className=\"w-6 h-6 text-orange-600\" />\n                    <div className=\"flex-1\">\n                      <div className=\"font-medium text-gray-800\">Ethereum (ETH)</div>\n                      <div className=\"text-sm text-gray-500\">\n                        Instant payment • StreamFlow escrow\n                      </div>\n                    </div>\n                    <div className=\"text-right\">\n                      <div className=\"text-sm font-medium text-orange-600\">Recommended</div>\n                    </div>\n                  </button>\n                )}\n\n                {/* Traditional Payment Methods */}\n                {paymentConditions?.hasPaymentMethod && (\n                  <>\n                    <button \n                      className=\"p-4 border border-gray-200 rounded-lg hover:border-green-400 hover:bg-green-50 transition-colors flex items-center gap-3 text-left\"\n                      onClick={() => handleMethodSelect('wechat')}\n                    >\n                      <MessageCircle className=\"w-6 h-6 text-green-600\" />\n                      <div>\n                        <div className=\"font-medium text-gray-800\">WeChat Pay</div>\n                        <div className=\"text-sm text-gray-500\">Scan QR code to pay</div>\n                      </div>\n                    </button>\n                    \n                    <button \n                      className=\"p-4 border border-gray-200 rounded-lg hover:border-blue-400 hover:bg-blue-50 transition-colors flex items-center gap-3 text-left\"\n                      onClick={() => handleMethodSelect('alipay')}\n                    >\n                      <CreditCard className=\"w-6 h-6 text-blue-600\" />\n                      <div>\n                        <div className=\"font-medium text-gray-800\">Alipay</div>\n                        <div className=\"text-sm text-gray-500\">Mobile payment</div>\n                      </div>\n                    </button>\n                    \n                    <button \n                      className=\"p-4 border border-gray-200 rounded-lg hover:border-purple-400 hover:bg-purple-50 transition-colors flex items-center gap-3 text-left\"\n                      onClick={() => handleMethodSelect('card')}\n                    >\n                      <Building className=\"w-6 h-6 text-purple-600\" />\n                      <div>\n                        <div className=\"font-medium text-gray-800\">Credit/Debit Card</div>\n                        <div className=\"text-sm text-gray-500\">International cards accepted</div>\n                      </div>\n                    </button>\n                  </>\n                )}\n              </div>\n            </div>\n          )}\n\n          {step === 'confirm-details' && selectedMethod && (\n            <div>\n              <h4 className=\"text-lg font-semibold text-gray-800 mb-4\">Confirm Purchase Details</h4>\n              \n              {/* Selected Payment Method */}\n              <div className=\"mb-4 p-3 bg-gray-50 rounded-lg\">\n                <div className=\"flex items-center gap-3\">\n                  {selectedMethod === 'solana' && <DollarSign className=\"w-5 h-5 text-orange-600\" />}\n                  {selectedMethod === 'wechat' && <MessageCircle className=\"w-5 h-5 text-green-600\" />}\n                  {selectedMethod === 'alipay' && <CreditCard className=\"w-5 h-5 text-blue-600\" />}\n                  {selectedMethod === 'card' && <Building className=\"w-5 h-5 text-purple-600\" />}\n                  <span className=\"font-medium\">\n                    {selectedMethod === 'solana' && 'Ethereum (ETH)'}\n                    {selectedMethod === 'wechat' && 'WeChat Pay'}\n                    {selectedMethod === 'alipay' && 'Alipay'}\n                    {selectedMethod === 'card' && 'Credit/Debit Card'}\n                  </span>\n                </div>\n              </div>\n\n              {/* Subscription Details */}\n              {isSubscription && (\n                <div className=\"mb-4 p-4 bg-blue-50 rounded-lg\">\n                  <div className=\"flex items-start gap-3\">\n                    <Calendar className=\"w-5 h-5 text-blue-600 mt-0.5\" />\n                    <div>\n                      <p className=\"font-medium text-blue-800\">Subscription Details</p>\n                      <p className=\"text-blue-700 text-sm mt-1\">\n                        {((project.subscription_price_per_period || project.price) / 100).toFixed(3)} ETH charged every {project.subscription_period}\n                      </p>\n                      <p className=\"text-blue-700 text-sm\">\n                        Total duration: {project.subscription_duration} {project.subscription_period}(s)\n                      </p>\n                    </div>\n                  </div>\n                </div>\n              )}\n\n              {/* StreamFlow Info for Solana */}\n              {selectedMethod === 'solana' && (\n                <div className=\"mb-4 p-4 bg-orange-50 rounded-lg\">\n                  <div className=\"flex items-start gap-3\">\n                    <DollarSign className=\"w-5 h-5 text-orange-600 mt-0.5\" />\n                    <div>\n                      <p className=\"font-medium text-orange-800\">StreamFlow Escrow</p>\n                      <p className=\"text-orange-700 text-sm mt-1\">\n                        {isSubscription \n                          ? 'Funds will be released to the seller according to the subscription schedule'\n                          : 'Funds will be released immediately upon confirmation'\n                        }\n                      </p>\n                    </div>\n                  </div>\n                </div>\n              )}\n\n              <div className=\"flex gap-3\">\n                <button\n                  onClick={() => setStep('select-method')}\n                  className=\"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors\"\n                >\n                  Back\n                </button>\n                <button\n                  onClick={handleConfirmPurchase}\n                  disabled={loading}\n                  className=\"flex-1 bg-primary text-white px-4 py-2 rounded-lg hover:bg-blue-600 disabled:opacity-50 transition-colors flex items-center justify-center gap-2\"\n                >\n                  {loading ? (\n                    <>\n                      <Loader2 className=\"w-4 h-4 animate-spin\" />\n                      Processing...\n                    </>\n                  ) : (\n                    <>\n                      <ShoppingCart className=\"w-4 h-4\" />\n                      Confirm Purchase\n                    </>\n                  )}\n                </button>\n              </div>\n            </div>\n          )}\n\n          {step === 'sablier-payment' && (\n            <div>\n              <h4 className=\"text-lg font-semibold text-gray-800 mb-4\">Complete Your Payment with Sablier</h4>\n              \n              {/* Sablier iframe */}\n              <div className=\"mb-6 border rounded-lg overflow-hidden\">\n                {sellerWalletAddress ? (\n                  <iframe\n                    src={`https://app.sablier.com/payments/create/?recipient=${encodeURIComponent(sellerWalletAddress)}&amount=${(totalAmount / 100).toFixed(3)}&token=ETH&duration=${isSubscription ? project.subscription_duration || 1 : 1}`}\n                    width=\"100%\"\n                    height=\"600px\"\n                    frameBorder=\"0\"\n                    style={{ border: 'none' }}\n                    title=\"Sablier Payment\"\n                    sandbox=\"allow-scripts allow-same-origin allow-forms allow-popups\"\n                  />\n                ) : (\n                  <div className=\"flex items-center justify-center h-[600px] bg-gray-50\">\n                    <div className=\"text-center\">\n                      <Loader2 className=\"w-8 h-8 text-primary animate-spin mx-auto mb-4\" />\n                      <p className=\"text-gray-600\">Loading payment interface...</p>\n                    </div>\n                  </div>\n                )}\n              </div>\n              \n              {/* Payment Instructions */}\n              <div className=\"mb-6 p-4 bg-blue-50 rounded-lg\">\n                <div className=\"flex items-start gap-3\">\n                  <DollarSign className=\"w-5 h-5 text-blue-600 mt-0.5\" />\n                  <div>\n                    <p className=\"font-medium text-blue-800\">Payment Instructions</p>\n                    <p className=\"text-blue-700 text-sm mt-1\">\n                      {isSubscription \n                        ? `Complete your ${project.subscription_period} payment stream of ${(totalAmount / 100).toFixed(3)} ETH to ${project.author}`\n                        : `Send ${(totalAmount / 100).toFixed(3)} ETH to ${project.author} using the Sablier interface above`\n                      }\n                    </p>\n                    <p className=\"text-blue-700 text-sm mt-2\">\n                      Once the payment is completed, click &quot;Payment Complete&quot; below.\n                    </p>\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"flex gap-3\">\n                <button\n                  onClick={() => setStep('confirm-details')}\n                  className=\"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors\"\n                >\n                  Back\n                </button>\n                <button\n                  onClick={() => setStep('success')}\n                  className=\"flex-1 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center gap-2\"\n                >\n                  <CheckCircle className=\"w-4 h-4\" />\n                  Payment Complete\n                </button>\n              </div>\n            </div>\n          )}\n\n          {step === 'processing' && (\n            <div className=\"text-center py-8\">\n              <Loader2 className=\"w-12 h-12 text-primary animate-spin mx-auto mb-4\" />\n              <h4 className=\"text-lg font-semibold text-gray-800 mb-2\">Processing Payment</h4>\n              <p className=\"text-gray-600\">\n                {selectedMethod === 'solana' \n                  ? 'Creating StreamFlow escrow and processing payment...'\n                  : 'Processing your payment...'\n                }\n              </p>\n              <div className=\"mt-4 text-sm text-gray-500\">\n                This may take a few moments. Please don&apos;t close this window.\n              </div>\n            </div>\n          )}\n\n          {step === 'success' && (\n            <div className=\"text-center py-8\">\n              <CheckCircle className=\"w-12 h-12 text-green-600 mx-auto mb-4\" />\n              <h4 className=\"text-lg font-semibold text-gray-800 mb-2\">Purchase Successful!</h4>\n              <p className=\"text-gray-600 mb-4\">\n                Your order has been processed successfully.\n              </p>\n              {orderId && (\n                <p className=\"text-sm text-gray-500 mb-4\">\n                  Order ID: {orderId}\n                </p>\n              )}\n              <button\n                onClick={handleClose}\n                className=\"bg-primary text-white px-6 py-2 rounded-lg hover:bg-blue-600 transition-colors\"\n              >\n                Continue\n              </button>\n            </div>\n          )}\n\n          {step === 'error' && (\n            <div className=\"text-center py-8\">\n              <AlertCircle className=\"w-12 h-12 text-red-600 mx-auto mb-4\" />\n              <h4 className=\"text-lg font-semibold text-gray-800 mb-2\">Payment Failed</h4>\n              {error && (\n                <p className=\"text-red-600 mb-4 text-sm\">{error}</p>\n              )}\n              <div className=\"flex gap-3 justify-center\">\n                <button\n                  onClick={handleClose}\n                  className=\"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors\"\n                >\n                  Close\n                </button>\n                {orderId && (\n                  <button\n                    onClick={handleRetry}\n                    disabled={loading}\n                    className=\"px-4 py-2 bg-primary text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 transition-colors flex items-center gap-2\"\n                  >\n                    {loading ? (\n                      <>\n                        <Loader2 className=\"w-4 h-4 animate-spin\" />\n                        Retrying...\n                      </>\n                    ) : (\n                      'Retry Payment'\n                    )}\n                  </button>\n                )}\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  )\n\n  return createPortal(modalContent, document.body)\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2892, "column": 0}, "map": {"version":3,"sources":["file:///Users/liyao/Code/workwork/frontend/Growth_OS/src/components/ContactSellerModal.tsx"],"sourcesContent":["'use client'\n\nimport { createPortal } from 'react-dom'\nimport { useState } from 'react'\nimport { X, Mail, Globe, Linkedin, Copy, CheckCircle } from 'lucide-react'\n\ninterface SellerInfo {\n  id: string\n  username: string\n  email: string\n  bio?: string\n  avatar?: string\n  wallet_address?: string\n  social_linkedin?: string\n  social_website?: string\n}\n\ninterface ContactSellerModalProps {\n  sellerInfo: SellerInfo | null\n  isOpen: boolean\n  onClose: () => void\n  mounted: boolean\n}\n\nexport function ContactSellerModal({ sellerInfo, isOpen, onClose, mounted }: ContactSellerModalProps) {\n  const [copiedField, setCopiedField] = useState<string | null>(null)\n\n  if (!isOpen || !mounted || !sellerInfo) return null\n\n  const handleCopy = async (text: string, fieldName: string) => {\n    try {\n      await navigator.clipboard.writeText(text)\n      setCopiedField(fieldName)\n      setTimeout(() => setCopiedField(null), 2000)\n    } catch (err) {\n      console.error('Failed to copy:', err)\n    }\n  }\n\n  const modalContent = (\n    <div \n      className=\"fixed inset-0 backdrop-blur-sm bg-white/20 flex items-center justify-center z-50 animate-fadeIn\" \n      onClick={onClose}\n    >\n      <div \n        className=\"bg-white rounded-lg max-w-md w-full mx-4 animate-slideUpAndScale\" \n        onClick={(e) => e.stopPropagation()}\n      >\n        {/* Header */}\n        <div className=\"flex items-center justify-between p-4 border-b\">\n          <h2 className=\"text-lg font-semibold text-gray-900\">Contact Seller</h2>\n          <button \n            onClick={onClose}\n            className=\"text-gray-400 hover:text-gray-600 p-1 rounded-full hover:bg-gray-100 transition-colors\"\n          >\n            <X className=\"w-5 h-5\" />\n          </button>\n        </div>\n\n        {/* Content */}\n        <div className=\"p-6\">\n          {/* Avatar and Basic Info */}\n          <div className=\"flex items-start gap-4 mb-6\">\n            <div className=\"w-16 h-16 rounded-full overflow-hidden bg-gray-100 flex-shrink-0\">\n              {sellerInfo.avatar ? (\n                <img \n                  src={sellerInfo.avatar} \n                  alt={sellerInfo.username}\n                  className=\"w-full h-full object-cover\"\n                />\n              ) : (\n                <div className=\"w-full h-full bg-gradient-to-br from-blue-400 to-purple-500 flex items-center justify-center text-white font-semibold text-lg\">\n                  {sellerInfo.username.charAt(0).toUpperCase()}\n                </div>\n              )}\n            </div>\n            <div className=\"flex-1\">\n              <h3 className=\"text-xl font-semibold text-gray-900 mb-1\">\n                {sellerInfo.username}\n              </h3>\n              {sellerInfo.bio && (\n                <p className=\"text-gray-600 text-sm leading-relaxed\">\n                  {sellerInfo.bio}\n                </p>\n              )}\n            </div>\n          </div>\n\n          {/* Contact Information */}\n          <div className=\"space-y-3\">\n            {/* Email */}\n            <div className=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg\">\n              <div className=\"flex items-center gap-3\">\n                <Mail className=\"w-4 h-4 text-gray-500\" />\n                <div>\n                  <p className=\"text-xs text-gray-500 mb-1\">Email</p>\n                  <p className=\"text-sm font-medium text-gray-900\">{sellerInfo.email}</p>\n                </div>\n              </div>\n              <button\n                onClick={() => handleCopy(sellerInfo.email, 'email')}\n                className=\"p-2 text-gray-400 hover:text-gray-600 hover:bg-white rounded-md transition-colors\"\n              >\n                {copiedField === 'email' ? (\n                  <CheckCircle className=\"w-4 h-4 text-green-500\" />\n                ) : (\n                  <Copy className=\"w-4 h-4\" />\n                )}\n              </button>\n            </div>\n\n            {/* SOL/Wallet Address */}\n            {sellerInfo.wallet_address && (\n              <div className=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg\">\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"w-4 h-4 bg-gradient-to-r from-purple-400 to-pink-400 rounded-full\" />\n                  <div className=\"flex-1 min-w-0\">\n                    <p className=\"text-xs text-gray-500 mb-1\">Wallet Address</p>\n                    <p className=\"text-sm font-mono text-gray-900 truncate\">\n                      {sellerInfo.wallet_address}\n                    </p>\n                  </div>\n                </div>\n                <button\n                  onClick={() => handleCopy(sellerInfo.wallet_address!, 'wallet')}\n                  className=\"p-2 text-gray-400 hover:text-gray-600 hover:bg-white rounded-md transition-colors flex-shrink-0\"\n                >\n                  {copiedField === 'wallet' ? (\n                    <CheckCircle className=\"w-4 h-4 text-green-500\" />\n                  ) : (\n                    <Copy className=\"w-4 h-4\" />\n                  )}\n                </button>\n              </div>\n            )}\n\n            {/* Social Links */}\n            {(sellerInfo.social_linkedin || sellerInfo.social_website) && (\n              <div className=\"space-y-2\">\n                <p className=\"text-xs text-gray-500 font-medium\">Social Links</p>\n                \n                {sellerInfo.social_linkedin && (\n                  <a\n                    href={sellerInfo.social_linkedin}\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                    className=\"flex items-center gap-3 p-3 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors\"\n                  >\n                    <Linkedin className=\"w-4 h-4 text-blue-600\" />\n                    <span className=\"text-sm text-blue-700 font-medium\">LinkedIn Profile</span>\n                  </a>\n                )}\n                \n                {sellerInfo.social_website && (\n                  <a\n                    href={sellerInfo.social_website}\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                    className=\"flex items-center gap-3 p-3 bg-green-50 hover:bg-green-100 rounded-lg transition-colors\"\n                  >\n                    <Globe className=\"w-4 h-4 text-green-600\" />\n                    <span className=\"text-sm text-green-700 font-medium\">Website</span>\n                  </a>\n                )}\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Footer */}\n        <div className=\"px-6 py-4 border-t bg-gray-50 rounded-b-lg\">\n          <p className=\"text-xs text-gray-500 text-center\">\n            Click to copy contact information or visit social links\n          </p>\n        </div>\n      </div>\n    </div>\n  )\n\n  return createPortal(modalContent, document.body)\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3291, "column": 0}, "map": {"version":3,"sources":["file:///Users/liyao/Code/workwork/frontend/Growth_OS/src/components/ImageCarousel.tsx"],"sourcesContent":["'use client'\n\nimport { useState } from 'react'\nimport { ChevronLeft, ChevronRight } from 'lucide-react'\nimport { ProductImage } from '@/types'\nimport { DEFAULT_PROJECT_IMAGE } from '@/lib/constants'\n\ninterface ImageCarouselProps {\n  images: ProductImage[]\n  projectName: string\n  className?: string\n}\n\nexport function ImageCarousel({ images, projectName, className = '' }: ImageCarouselProps) {\n  const [currentIndex, setCurrentIndex] = useState(0)\n  \n  // 如果没有图片，使用默认图片\n  const displayImages = images.length > 0 ? images : [\n    { url: DEFAULT_PROJECT_IMAGE, alt: `${projectName} - Default Image` }\n  ]\n  \n  const goToPrevious = () => {\n    setCurrentIndex((prevIndex) => \n      prevIndex === 0 ? displayImages.length - 1 : prevIndex - 1\n    )\n  }\n  \n  const goToNext = () => {\n    setCurrentIndex((prevIndex) => \n      prevIndex === displayImages.length - 1 ? 0 : prevIndex + 1\n    )\n  }\n  \n  const goToSlide = (index: number) => {\n    setCurrentIndex(index)\n  }\n  \n  return (\n    <div className={`relative group ${className}`}>\n      {/* Main Image */}\n      <div className=\"w-full overflow-hidden rounded-lg bg-gray-100\">\n        <img \n          src={displayImages[currentIndex].url}\n          alt={displayImages[currentIndex].alt}\n          className=\"w-full h-auto object-contain transition-opacity duration-300\"\n          style={{ maxHeight: '400px' }}\n          onError={(e) => {\n            e.currentTarget.src = DEFAULT_PROJECT_IMAGE\n          }}\n        />\n      </div>\n      \n      {/* Navigation Arrows - 只在多图时显示 */}\n      {displayImages.length > 1 && (\n        <>\n          <button \n            onClick={goToPrevious}\n            className=\"absolute left-2 top-1/2 -translate-y-1/2 bg-black/50 hover:bg-black/70 text-white p-2 rounded-full opacity-0 group-hover:opacity-100 transition-all duration-200\"\n            aria-label=\"Previous image\"\n          >\n            <ChevronLeft className=\"w-5 h-5\" />\n          </button>\n          \n          <button \n            onClick={goToNext}\n            className=\"absolute right-2 top-1/2 -translate-y-1/2 bg-black/50 hover:bg-black/70 text-white p-2 rounded-full opacity-0 group-hover:opacity-100 transition-all duration-200\"\n            aria-label=\"Next image\"\n          >\n            <ChevronRight className=\"w-5 h-5\" />\n          </button>\n        </>\n      )}\n      \n      {/* Dots Indicator - 只在多图时显示 */}\n      {displayImages.length > 1 && (\n        <div className=\"absolute bottom-4 left-1/2 -translate-x-1/2 flex space-x-2\">\n          {displayImages.map((_, index) => (\n            <button\n              key={index}\n              onClick={() => goToSlide(index)}\n              className={`w-2 h-2 rounded-full transition-all duration-200 ${\n                index === currentIndex \n                  ? 'bg-white scale-125' \n                  : 'bg-white/50 hover:bg-white/80'\n              }`}\n              aria-label={`Go to image ${index + 1}`}\n            />\n          ))}\n        </div>\n      )}\n      \n      {/* Image Counter - 只在多图时显示 */}\n      {displayImages.length > 1 && (\n        <div className=\"absolute top-4 right-4 bg-black/50 text-white px-2 py-1 rounded text-sm\">\n          {currentIndex + 1} / {displayImages.length}\n        </div>\n      )}\n    </div>\n  )\n}"],"names":[],"mappings":";;;;AAEA;AACA;AAAA;AAEA;;;AALA;;;;AAaO,SAAS,cAAc,KAA2D;QAA3D,EAAE,MAAM,EAAE,WAAW,EAAE,YAAY,EAAE,EAAsB,GAA3D;;IAC5B,MAAM,CAAC,cAAc,gBAAgB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAEjD,gBAAgB;IAChB,MAAM,gBAAgB,OAAO,MAAM,GAAG,IAAI,SAAS;QACjD;YAAE,KAAK,0HAAA,CAAA,wBAAqB;YAAE,KAAK,AAAC,GAAc,OAAZ,aAAY;QAAkB;KACrE;IAED,MAAM,eAAe;QACnB,gBAAgB,CAAC,YACf,cAAc,IAAI,cAAc,MAAM,GAAG,IAAI,YAAY;IAE7D;IAEA,MAAM,WAAW;QACf,gBAAgB,CAAC,YACf,cAAc,cAAc,MAAM,GAAG,IAAI,IAAI,YAAY;IAE7D;IAEA,MAAM,YAAY,CAAC;QACjB,gBAAgB;IAClB;IAEA,qBACE,6LAAC;QAAI,WAAW,AAAC,kBAA2B,OAAV;;0BAEhC,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBACC,KAAK,aAAa,CAAC,aAAa,CAAC,GAAG;oBACpC,KAAK,aAAa,CAAC,aAAa,CAAC,GAAG;oBACpC,WAAU;oBACV,OAAO;wBAAE,WAAW;oBAAQ;oBAC5B,SAAS,CAAC;wBACR,EAAE,aAAa,CAAC,GAAG,GAAG,0HAAA,CAAA,wBAAqB;oBAC7C;;;;;;;;;;;YAKH,cAAc,MAAM,GAAG,mBACtB;;kCACE,6LAAC;wBACC,SAAS;wBACT,WAAU;wBACV,cAAW;kCAEX,cAAA,6LAAC,uNAAA,CAAA,cAAW;4BAAC,WAAU;;;;;;;;;;;kCAGzB,6LAAC;wBACC,SAAS;wBACT,WAAU;wBACV,cAAW;kCAEX,cAAA,6LAAC,yNAAA,CAAA,eAAY;4BAAC,WAAU;;;;;;;;;;;;;YAM7B,cAAc,MAAM,GAAG,mBACtB,6LAAC;gBAAI,WAAU;0BACZ,cAAc,GAAG,CAAC,CAAC,GAAG,sBACrB,6LAAC;wBAEC,SAAS,IAAM,UAAU;wBACzB,WAAW,AAAC,oDAIX,OAHC,UAAU,eACN,uBACA;wBAEN,cAAY,AAAC,eAAwB,OAAV,QAAQ;uBAP9B;;;;;;;;;;YAcZ,cAAc,MAAM,GAAG,mBACtB,6LAAC;gBAAI,WAAU;;oBACZ,eAAe;oBAAE;oBAAI,cAAc,MAAM;;;;;;;;;;;;;AAKpD;GAtFgB;KAAA","debugId":null}},
    {"offset": {"line": 3434, "column": 0}, "map": {"version":3,"sources":["file:///Users/liyao/Code/workwork/frontend/Growth_OS/src/components/ProjectModal.tsx"],"sourcesContent":["'use client'\n\nimport { createPortal } from 'react-dom'\nimport { useState } from 'react'\nimport { Project, SellerInfo } from '@/types'\nimport { TAG_COLORS, DEFAULT_PROJECT_IMAGE } from '@/lib/constants'\nimport { ShoppingCart, MessageCircle, DollarSign, Eye, Heart, Star } from 'lucide-react'\nimport { PurchaseConfirmModal } from './PurchaseConfirmModal'\nimport { ContactSellerModal } from './ContactSellerModal'\nimport { ImageCarousel } from './ImageCarousel'\n\ninterface ProjectModalProps {\n  project: Project\n  isOpen: boolean\n  onClose: () => void\n  mounted: boolean\n}\n\nexport function ProjectModal({ project, isOpen, onClose, mounted }: ProjectModalProps) {\n  const [showPurchaseModal, setShowPurchaseModal] = useState(false)\n  const [showContactModal, setShowContactModal] = useState(false)\n  const [sellerInfo, setSellerInfo] = useState<SellerInfo | null>(null)\n  \n  if (!isOpen || !mounted) return null\n\n  const modalContent = (\n    <div \n      className=\"fixed inset-0 backdrop-blur-sm bg-white/20 flex items-center justify-center z-50 animate-fadeIn\" \n      onClick={onClose}\n    >\n      <div \n        className=\"bg-white rounded-lg max-w-2xl max-h-[80vh] overflow-y-auto m-4 animate-slideUpAndScale\" \n        onClick={(e) => e.stopPropagation()}\n      >\n        <div className=\"sticky top-0 bg-white border-b p-4 flex items-start justify-between z-20 shadow-sm\">\n          <div className=\"flex-1\">\n            <h2 className=\"text-xl font-bold text-text-primary mb-1\">{project.name}</h2>\n            <p className=\"text-text-tertiary text-sm\">by {project.author}</p>\n            <div className=\"mt-2 flex items-center gap-4\">\n              <div className=\"flex items-center\">\n                <DollarSign className=\"w-4 h-4 text-primary mr-1\" />\n                <span className=\"text-primary text-lg font-bold font-brand mr-1\">ETH</span>\n                <span className=\"text-primary text-2xl font-bold font-brand\">\n                  {project.pricing_model === 'subscription' && project.subscription_price_per_period \n                    ? (project.subscription_price_per_period / 100).toFixed(3) \n                    : (project.price / 100).toFixed(3)}\n                </span>\n                {project.pricing_model === 'subscription' && project.subscription_period && (\n                  <span className=\"text-primary text-sm font-medium ml-1\">\n                    /{project.subscription_period === 'daily' ? 'day' : \n                      project.subscription_period === 'weekly' ? 'week' :\n                      project.subscription_period === 'monthly' ? 'month' : \n                      project.subscription_period === 'yearly' ? 'year' : 'period'}\n                  </span>\n                )}\n              </div>\n              {project.pricing_model === 'subscription' && (\n                <div className=\"px-2 py-1 bg-purple-100 text-purple-800 rounded text-xs font-medium\">\n                  Subscription\n                </div>\n              )}\n              <div className=\"flex items-center gap-3 text-sm text-gray-600\">\n                <div className=\"flex items-center\">\n                  <Eye className=\"w-4 h-4 mr-1\" />\n                  {project.views || 0}\n                </div>\n                <div className=\"flex items-center\">\n                  <Heart className=\"w-4 h-4 mr-1\" />\n                  {project.likes || 0}\n                </div>\n                <div className=\"flex items-center\">\n                  <Star className=\"w-4 h-4 mr-1 text-yellow-500\" />\n                  {project.rating || 0}\n                </div>\n              </div>\n            </div>\n          </div>\n          <button \n            onClick={onClose}\n            className=\"text-gray-400 hover:text-gray-600 text-2xl font-light ml-4\"\n          >\n            ×\n          </button>\n        </div>\n        \n        <div className=\"p-4 relative z-0\">\n          <div className=\"w-full mb-4\">\n            <ImageCarousel \n              images={project.images || []}\n              projectName={project.name}\n              className=\"w-full\"\n            />\n          </div>\n          \n          <div className=\"mb-4\">\n            <h3 className=\"text-lg font-semibold text-text-primary mb-2\">Description</h3>\n            <p className=\"text-text-primary text-sm leading-relaxed whitespace-pre-line\">\n              {project.description}\n            </p>\n          </div>\n          \n          <div className=\"mb-6\">\n            <h3 className=\"text-lg font-semibold text-text-primary mb-2\">Tags</h3>\n            <div className=\"flex flex-wrap gap-2\">\n              {project.tags.map((tag, index) => (\n                <span\n                  key={index}\n                  className={`px-3 py-1 rounded-lg text-sm font-medium shadow-tag ${TAG_COLORS[tag.type]}`}\n                >\n                  {tag.label}\n                </span>\n              ))}\n            </div>\n          </div>\n\n          {/* Subscription Details */}\n          {project.pricing_model === 'subscription' && project.subscription_prices && (\n            <div className=\"mb-6\">\n              <h3 className=\"text-lg font-semibold text-text-primary mb-2\">Subscription Pricing</h3>\n              <div className=\"grid grid-cols-2 gap-3 bg-gray-50 p-4 rounded-lg\">\n                {project.subscription_prices.daily && (\n                  <div className=\"text-sm\">\n                    <span className=\"text-gray-600\">Daily:</span>\n                    <span className=\"font-medium ml-1\">ETH {(project.subscription_prices.daily / 100).toFixed(3)}</span>\n                  </div>\n                )}\n                {project.subscription_prices.weekly && (\n                  <div className=\"text-sm\">\n                    <span className=\"text-gray-600\">Weekly:</span>\n                    <span className=\"font-medium ml-1\">ETH {(project.subscription_prices.weekly / 100).toFixed(3)}</span>\n                  </div>\n                )}\n                {project.subscription_prices.monthly && (\n                  <div className=\"text-sm\">\n                    <span className=\"text-gray-600\">Monthly:</span>\n                    <span className=\"font-medium ml-1\">ETH {(project.subscription_prices.monthly / 100).toFixed(3)}</span>\n                  </div>\n                )}\n                {project.subscription_prices.yearly && (\n                  <div className=\"text-sm\">\n                    <span className=\"text-gray-600\">Yearly:</span>\n                    <span className=\"font-medium ml-1\">ETH {(project.subscription_prices.yearly / 100).toFixed(3)}</span>\n                  </div>\n                )}\n              </div>\n              <p className=\"text-xs text-gray-500 mt-2\">\n                Subscribers can choose the subscription period that suits their needs\n              </p>\n            </div>\n          )}\n\n          {/* Action Buttons */}\n          <div className=\"border-t pt-4\">\n            <div className=\"flex gap-3\">\n              <button \n                className=\"flex-1 bg-primary text-white px-6 py-3 rounded-lg hover:bg-blue-600 transition-colors flex items-center justify-center gap-2 font-medium\"\n                onClick={() => setShowPurchaseModal(true)}\n              >\n                <ShoppingCart className=\"w-5 h-5\" />\n                {project.product_type === 'subscription' \n                  ? `Subscribe - ${((project.subscription_price_per_period || project.price) / 100).toFixed(3)} ETH/${project.subscription_period}`\n                  : `Buy Now - ${(project.price / 100).toFixed(3)} ETH`\n                }\n              </button>\n              <button \n                className=\"px-6 py-3 border border-primary text-primary rounded-lg hover:bg-blue-50 transition-colors flex items-center gap-2 font-medium\"\n                onClick={() => handleContact(project)}\n              >\n                <MessageCircle className=\"w-5 h-5\" />\n                Contact Seller\n              </button>\n            </div>\n            \n            <p className=\"text-xs text-gray-500 mt-2 text-center\">\n              Multiple payment methods available\n            </p>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n\n\n  // Handle contact seller\n  async function handleContact(project: Project) {\n    try {\n      // Mock seller info - in a real app, you'd fetch this from your API\n      const mockSellerInfo: SellerInfo = {\n        id: project.author_id || '1',\n        username: project.author,\n        email: `${project.author.toLowerCase().replace(/\\s+/g, '')}@example.com`,\n        bio: `Hi! I'm ${project.author}, passionate about creating amazing digital products. Feel free to reach out for any questions about my work.`,\n        avatar: `https://api.dicebear.com/7.x/avataaars/svg?seed=${project.author}`,\n        wallet_address: '0x742d35Cc6634C0532925a3b8D41B2C02D32A8efb',\n        social_linkedin: `https://linkedin.com/in/${project.author.toLowerCase().replace(/\\s+/g, '')}`,\n        social_website: `https://${project.author.toLowerCase().replace(/\\s+/g, '')}.dev`\n      }\n      \n      setSellerInfo(mockSellerInfo)\n      setShowContactModal(true)\n    } catch (error) {\n      console.error('Failed to load seller info:', error)\n    }\n  }\n\n  return (\n    <>\n      {createPortal(modalContent, document.body)}\n      <PurchaseConfirmModal \n        project={project}\n        isOpen={showPurchaseModal}\n        onClose={() => setShowPurchaseModal(false)}\n        mounted={mounted}\n      />\n      <ContactSellerModal \n        sellerInfo={sellerInfo}\n        isOpen={showContactModal}\n        onClose={() => setShowContactModal(false)}\n        mounted={mounted}\n      />\n    </>\n  )\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 4000, "column": 0}, "map": {"version":3,"sources":["file:///Users/liyao/Code/workwork/frontend/Growth_OS/src/components/ProjectCard.tsx"],"sourcesContent":["'use client'\n\nimport { useEffect } from 'react'\nimport type { Project } from '@/types'\nimport { TAG_COLORS, DEFAULT_PROJECT_IMAGE } from '@/lib/constants'\nimport { useModal } from '@/hooks/useModal'\nimport { ProjectModal } from './ProjectModal'\nimport { Eye, Heart, Star, CheckCircle } from 'lucide-react'\n\ninterface ProjectCardProps extends Project {\n  initialOpen?: boolean\n}\n\nexport function ProjectCard(props: ProjectCardProps) {\n  const { initialOpen, ...project } = props\n  const modal = useModal()\n  \n  // 如果有initialOpen属性，自动打开模态框\n  useEffect(() => {\n    if (initialOpen) {\n      modal.open()\n    }\n  }, [initialOpen, modal])\n  \n\n  return (\n    <>\n      <div \n        className=\"w-full max-w-[280px] h-[360px] bg-bg-primary rounded-lg shadow-card overflow-hidden flex flex-col hover:shadow-xl hover:scale-105 transition-all duration-300 cursor-pointer\"\n        onClick={modal.open}\n      >\n        <div \n          className=\"h-[180px] w-full rounded-t-lg\"\n          style={{\n            backgroundImage: `url(${project.image || project.image_url || DEFAULT_PROJECT_IMAGE})`,\n            backgroundSize: 'cover',\n            backgroundPosition: 'center',\n            backgroundRepeat: 'no-repeat'\n          }}\n        />\n        \n        <div className=\"h-[180px] px-4 py-3 bg-white flex flex-col\">\n          {/* Header section: fixed height */}\n          <div className=\"flex items-start justify-between mb-2 h-[50px] shrink-0\">\n            <div className=\"flex-1 mr-3\">\n              <h3 className=\"text-text-primary text-base font-bold line-clamp-1 leading-tight mb-1\">\n                {project.name}\n              </h3>\n              <p className=\"text-text-tertiary text-[10px] line-clamp-1 leading-tight\">\n                {project.author}\n              </p>\n            </div>\n            \n            <div className=\"text-right shrink-0\">\n              <div className=\"leading-tight\">\n                <span className=\"text-primary text-base font-bold font-brand mr-1\">\n                  ETH\n                </span>\n                <span className=\"text-primary text-2xl font-bold font-brand\">\n                  {project.pricing_model === 'subscription' && project.subscription_price_per_period \n                    ? (project.subscription_price_per_period / 100).toFixed(3) \n                    : (project.price / 100).toFixed(3)}\n                </span>\n                {project.pricing_model === 'subscription' && project.subscription_period && (\n                  <div className=\"text-primary text-xs font-medium mt-0.5\">\n                    /{project.subscription_period === 'daily' ? 'day' : \n                      project.subscription_period === 'weekly' ? 'week' :\n                      project.subscription_period === 'monthly' ? 'month' : \n                      project.subscription_period === 'yearly' ? 'year' : 'period'}\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n\n          {/* Description section: fixed height with overflow control */}\n          <div className=\"h-[70px] mb-2 overflow-hidden shrink-0 relative\">\n            <p className=\"text-text-primary text-xs leading-[1.4] line-clamp-3 overflow-hidden mb-1\">\n              {project.description.length > 80 ? project.description.substring(0, 80) + '...' : project.description}\n            </p>\n            <div className=\"text-center absolute bottom-0 left-0 right-0\">\n              <span className=\"text-primary text-xs cursor-pointer hover:underline bg-white px-2\">\n                Click for details\n              </span>\n            </div>\n          </div>\n\n          {/* Tags section: fixed height to prevent overflow */}\n          <div className=\"h-[24px] mb-2 shrink-0 overflow-hidden\">\n            <div className=\"flex flex-wrap gap-1\">\n              {project.tags.slice(0, 2).map((tag, index) => (\n                <span\n                  key={index}\n                  className={`px-2 py-0.5 rounded-lg text-xs font-medium shadow-tag ${TAG_COLORS[tag.type]} truncate max-w-[80px]`}\n                  title={tag.label}\n                >\n                  {tag.label}\n                </span>\n              ))}\n              {project.tags.length > 2 && (\n                <span className=\"text-text-secondary text-xs self-center\">\n                  +{project.tags.length - 2}\n                </span>\n              )}\n            </div>\n          </div>\n\n          {/* Statistics: fixed at bottom */}\n          <div className=\"flex items-center justify-between mt-auto pt-2 border-t border-gray-100 shrink-0\">\n            <div className=\"flex items-center space-x-3 text-xs text-text-secondary\">\n              <div className=\"flex items-center space-x-1\">\n                <Eye className=\"w-3 h-3\" />\n                <span>{project.views}</span>\n              </div>\n              <div className=\"flex items-center space-x-1\">\n                <Heart className=\"w-3 h-3\" />\n                <span>{project.likes}</span>\n              </div>\n              <div className=\"flex items-center space-x-1\">\n                <Star className=\"w-3 h-3\" />\n                <span>{project.rating ? project.rating.toFixed(1) : '0.0'}</span>\n              </div>\n            </div>\n            \n            <div className=\"text-green-500 text-sm\" title=\"Verified Creator\">\n              <CheckCircle className=\"w-4 h-4\" />\n            </div>\n          </div>\n        </div>\n      </div>\n      \n      <ProjectModal\n        project={project}\n        isOpen={modal.isOpen}\n        onClose={modal.close}\n        mounted={modal.mounted}\n      />\n    </>\n  )\n}"],"names":[],"mappings":";;;;AAEA;AAEA;AACA;AACA;AACA;AAAA;AAAA;AAAA;;;AAPA;;;;;;AAaO,SAAS,YAAY,KAAuB;;IACjD,MAAM,EAAE,WAAW,EAAE,GAAG,SAAS,GAAG;IACpC,MAAM,QAAQ,CAAA,GAAA,2HAAA,CAAA,WAAQ,AAAD;IAErB,2BAA2B;IAC3B,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;iCAAE;YACR,IAAI,aAAa;gBACf,MAAM,IAAI;YACZ;QACF;gCAAG;QAAC;QAAa;KAAM;IAGvB,qBACE;;0BACE,6LAAC;gBACC,WAAU;gBACV,SAAS,MAAM,IAAI;;kCAEnB,6LAAC;wBACC,WAAU;wBACV,OAAO;4BACL,iBAAiB,AAAC,OAAkE,OAA5D,QAAQ,KAAK,IAAI,QAAQ,SAAS,IAAI,0HAAA,CAAA,wBAAqB,EAAC;4BACpF,gBAAgB;4BAChB,oBAAoB;4BACpB,kBAAkB;wBACpB;;;;;;kCAGF,6LAAC;wBAAI,WAAU;;0CAEb,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;gDAAG,WAAU;0DACX,QAAQ,IAAI;;;;;;0DAEf,6LAAC;gDAAE,WAAU;0DACV,QAAQ,MAAM;;;;;;;;;;;;kDAInB,6LAAC;wCAAI,WAAU;kDACb,cAAA,6LAAC;4CAAI,WAAU;;8DACb,6LAAC;oDAAK,WAAU;8DAAmD;;;;;;8DAGnE,6LAAC;oDAAK,WAAU;8DACb,QAAQ,aAAa,KAAK,kBAAkB,QAAQ,6BAA6B,GAC9E,CAAC,QAAQ,6BAA6B,GAAG,GAAG,EAAE,OAAO,CAAC,KACtD,CAAC,QAAQ,KAAK,GAAG,GAAG,EAAE,OAAO,CAAC;;;;;;gDAEnC,QAAQ,aAAa,KAAK,kBAAkB,QAAQ,mBAAmB,kBACtE,6LAAC;oDAAI,WAAU;;wDAA0C;wDACrD,QAAQ,mBAAmB,KAAK,UAAU,QAC1C,QAAQ,mBAAmB,KAAK,WAAW,SAC3C,QAAQ,mBAAmB,KAAK,YAAY,UAC5C,QAAQ,mBAAmB,KAAK,WAAW,SAAS;;;;;;;;;;;;;;;;;;;;;;;;0CAQhE,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAE,WAAU;kDACV,QAAQ,WAAW,CAAC,MAAM,GAAG,KAAK,QAAQ,WAAW,CAAC,SAAS,CAAC,GAAG,MAAM,QAAQ,QAAQ,WAAW;;;;;;kDAEvG,6LAAC;wCAAI,WAAU;kDACb,cAAA,6LAAC;4CAAK,WAAU;sDAAoE;;;;;;;;;;;;;;;;;0CAOxF,6LAAC;gCAAI,WAAU;0CACb,cAAA,6LAAC;oCAAI,WAAU;;wCACZ,QAAQ,IAAI,CAAC,KAAK,CAAC,GAAG,GAAG,GAAG,CAAC,CAAC,KAAK,sBAClC,6LAAC;gDAEC,WAAW,AAAC,yDAA6E,OAArB,0HAAA,CAAA,aAAU,CAAC,IAAI,IAAI,CAAC,EAAC;gDACzF,OAAO,IAAI,KAAK;0DAEf,IAAI,KAAK;+CAJL;;;;;wCAOR,QAAQ,IAAI,CAAC,MAAM,GAAG,mBACrB,6LAAC;4CAAK,WAAU;;gDAA0C;gDACtD,QAAQ,IAAI,CAAC,MAAM,GAAG;;;;;;;;;;;;;;;;;;0CAOhC,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;gDAAI,WAAU;;kEACb,6LAAC,mMAAA,CAAA,MAAG;wDAAC,WAAU;;;;;;kEACf,6LAAC;kEAAM,QAAQ,KAAK;;;;;;;;;;;;0DAEtB,6LAAC;gDAAI,WAAU;;kEACb,6LAAC,uMAAA,CAAA,QAAK;wDAAC,WAAU;;;;;;kEACjB,6LAAC;kEAAM,QAAQ,KAAK;;;;;;;;;;;;0DAEtB,6LAAC;gDAAI,WAAU;;kEACb,6LAAC,qMAAA,CAAA,OAAI;wDAAC,WAAU;;;;;;kEAChB,6LAAC;kEAAM,QAAQ,MAAM,GAAG,QAAQ,MAAM,CAAC,OAAO,CAAC,KAAK;;;;;;;;;;;;;;;;;;kDAIxD,6LAAC;wCAAI,WAAU;wCAAyB,OAAM;kDAC5C,cAAA,6LAAC,8NAAA,CAAA,cAAW;4CAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;0BAM/B,6LAAC,qIAAA,CAAA,eAAY;gBACX,SAAS;gBACT,QAAQ,MAAM,MAAM;gBACpB,SAAS,MAAM,KAAK;gBACpB,SAAS,MAAM,OAAO;;;;;;;;AAI9B;GA9HgB;;QAEA,2HAAA,CAAA,WAAQ;;;KAFR","debugId":null}},
    {"offset": {"line": 4346, "column": 0}, "map": {"version":3,"sources":["file:///Users/liyao/Code/workwork/frontend/Growth_OS/src/lib/products.ts"],"sourcesContent":["import { supabase } from './supabase'\nimport { Project, Tag, ProductImage, ProductZone } from '@/types'\n\nexport interface ProductsFilter {\n  category?: string\n  zone?: ProductZone\n  sortBy?: 'created_at' | 'price' | 'views' | 'likes' | 'rating'\n  sortOrder?: 'asc' | 'desc'\n  limit?: number\n  offset?: number\n}\n\nexport class ProductsService {\n  // 获取所有产品\n  static async getProducts(filter: ProductsFilter = {}): Promise<Project[]> {\n    if (!supabase) {\n      console.warn('Supabase not configured, returning empty array')\n      return []\n    }\n\n    try {\n      let query = supabase\n        .from('products')\n        .select('*')\n        .eq('status', 'active')\n\n      // 应用过滤器\n      if (filter.category) {\n        query = query.eq('category', filter.category)\n      }\n      \n      if (filter.zone && filter.zone !== 'all') {\n        query = query.eq('zone', filter.zone)\n      }\n\n      // 应用排序\n      if (filter.sortBy) {\n        query = query.order(filter.sortBy, { \n          ascending: filter.sortOrder === 'asc' \n        })\n      } else {\n        // 默认按创建时间倒序\n        query = query.order('created_at', { ascending: false })\n      }\n\n      // 应用分页\n      if (filter.limit) {\n        query = query.limit(filter.limit)\n      }\n      if (filter.offset) {\n        query = query.range(filter.offset, filter.offset + (filter.limit || 10) - 1)\n      }\n\n      const { data, error } = await query\n\n      if (error) {\n        console.error('Error fetching products:', error)\n        return []\n      }\n\n      return data?.map(item => ProductsService.transformProduct(item)) || []\n    } catch (error) {\n      console.error('Error in getProducts:', error)\n      return []\n    }\n  }\n\n  // 获取用户产品（包括所有状态）\n  static async getUserProducts(userId: string, includeDeleted = false): Promise<Project[]> {\n    if (!supabase) {\n      console.warn('Supabase not configured, returning empty array')\n      return []\n    }\n\n    try {\n      let query = supabase\n        .from('products')\n        .select('*')\n        .eq('author_id', userId)\n\n      if (!includeDeleted) {\n        query = query.neq('status', 'deleted')\n      }\n\n      query = query.order('created_at', { ascending: false })\n\n      const { data, error } = await query\n\n      if (error) {\n        console.error('Error fetching user products:', error)\n        return []\n      }\n\n      return data?.map(item => ProductsService.transformProduct(item)) || []\n    } catch (error) {\n      console.error('Error in getUserProducts:', error)\n      return []\n    }\n  }\n\n  // 根据ID获取单个产品\n  static async getProductById(id: string): Promise<Project | null> {\n    if (!supabase) {\n      console.warn('Supabase not configured')\n      return null\n    }\n\n    try {\n      const { data, error } = await supabase\n        .from('products')\n        .select('*')\n        .eq('id', id)\n        .eq('status', 'active')\n        .single()\n\n      if (error) {\n        console.error('Error fetching product:', error)\n        return null\n      }\n\n      return data ? ProductsService.transformProduct(data) : null\n    } catch (error) {\n      console.error('Error in getProductById:', error)\n      return null\n    }\n  }\n\n  // 增加产品浏览次数\n  static async incrementViews(productId: string): Promise<void> {\n    if (!supabase) return\n\n    try {\n      await supabase.rpc('increment_product_views', {\n        product_id: productId\n      })\n    } catch (error) {\n      console.error('Error incrementing views:', error)\n    }\n  }\n\n  // 切换产品点赞状态\n  static async toggleLike(productId: string, isLiked: boolean): Promise<void> {\n    if (!supabase) return\n\n    try {\n      await supabase.rpc('toggle_product_like', {\n        product_id: productId,\n        increment: !isLiked // 如果当前已点赞，则取消（减少）；否则增加\n      })\n    } catch (error) {\n      console.error('Error toggling like:', error)\n    }\n  }\n\n  // 获取产品类别列表\n  static async getCategories(): Promise<string[]> {\n    if (!supabase) return []\n\n    try {\n      const { data, error } = await supabase\n        .from('products')\n        .select('category')\n        .eq('status', 'active')\n\n      if (error) {\n        console.error('Error fetching categories:', error)\n        return []\n      }\n\n      // 去重并排序\n      const categories = [...new Set(data.map(item => item.category))]\n      return categories.filter(Boolean).sort()\n    } catch (error) {\n      console.error('Error in getCategories:', error)\n      return []\n    }\n  }\n\n  // 搜索产品\n  static async searchProducts(query: string, filter: ProductsFilter = {}): Promise<Project[]> {\n    if (!supabase || !query.trim()) {\n      return this.getProducts(filter)\n    }\n\n    try {\n      let dbQuery = supabase\n        .from('products')\n        .select('*')\n        .eq('status', 'active')\n        .or(`name.ilike.%${query}%,description.ilike.%${query}%,author_name.ilike.%${query}%`)\n\n      // 应用过滤器\n      if (filter.category) {\n        dbQuery = dbQuery.eq('category', filter.category)\n      }\n      \n      if (filter.zone && filter.zone !== 'all') {\n        dbQuery = dbQuery.eq('zone', filter.zone)\n      }\n\n      // 应用排序\n      if (filter.sortBy) {\n        dbQuery = dbQuery.order(filter.sortBy, { \n          ascending: filter.sortOrder === 'asc' \n        })\n      } else {\n        dbQuery = dbQuery.order('created_at', { ascending: false })\n      }\n\n      // 应用分页\n      if (filter.limit) {\n        dbQuery = dbQuery.limit(filter.limit)\n      }\n\n      const { data, error } = await dbQuery\n\n      if (error) {\n        console.error('Error searching products:', error)\n        return []\n      }\n\n      return data?.map(item => ProductsService.transformProduct(item)) || []\n    } catch (error) {\n      console.error('Error in searchProducts:', error)\n      return []\n    }\n  }\n\n  // 转换数据库数据为前端使用的格式\n  static transformProduct(dbProduct: Record<string, unknown>): Project {\n    const images = ProductsService.parseImages(dbProduct.images)\n    const firstImage = images.length > 0 ? images[0].url : undefined\n    \n    return {\n      id: dbProduct.id as string,\n      name: dbProduct.name as string,\n      author: dbProduct.author_name as string,\n      author_id: dbProduct.author_id as string,\n      author_name: dbProduct.author_name as string,\n      description: dbProduct.description as string,\n      price: parseFloat(dbProduct.price as string),\n      currency: dbProduct.currency as string,\n      category: dbProduct.category as string,\n      zone: dbProduct.zone as ProductZone,\n      image: firstImage, // 向后兼容，使用第一张图片\n      image_url: firstImage, // 向后兼容，使用第一张图片\n      images: images, // 新的多图字段\n      tags: ProductsService.parseTags(dbProduct.tags),\n      views: (dbProduct.views as number) || 0,\n      likes: (dbProduct.likes as number) || 0,\n      rating: parseFloat((dbProduct.rating as string) || '0') || 0,\n      verified: true, // 可以基于作者验证状态设置\n      status: dbProduct.status as 'active' | 'inactive' | 'deleted',\n      created_at: dbProduct.created_at as string,\n      updated_at: dbProduct.updated_at as string,\n      // 订阅相关字段\n      product_type: dbProduct.product_type as 'product' | 'subscription',\n      pricing_model: dbProduct.pricing_model as 'one_time' | 'subscription',\n      subscription_period: dbProduct.subscription_period as 'daily' | 'weekly' | 'monthly' | 'yearly',\n      subscription_price_per_period: dbProduct.subscription_price_per_period ? parseFloat(dbProduct.subscription_price_per_period as string) : undefined,\n      subscription_duration: dbProduct.subscription_duration as number,\n      subscription_prices: ProductsService.parseSubscriptionPrices(dbProduct.subscription_prices)\n    }\n  }\n\n  // 解析标签JSON数据\n  static parseTags(tagsJson: unknown): Tag[] {\n    if (!tagsJson) return []\n    \n    try {\n      if (typeof tagsJson === 'string') {\n        return JSON.parse(tagsJson)\n      }\n      return Array.isArray(tagsJson) ? tagsJson : []\n    } catch (error) {\n      console.error('Error parsing tags:', error)\n      return []\n    }\n  }\n\n  // 解析图片JSON数据\n  static parseImages(imagesJson: unknown): ProductImage[] {\n    if (!imagesJson) return []\n    \n    try {\n      if (typeof imagesJson === 'string') {\n        return JSON.parse(imagesJson)\n      }\n      return Array.isArray(imagesJson) ? imagesJson : []\n    } catch (error) {\n      console.error('Error parsing images:', error)\n      return []\n    }\n  }\n\n  // 解析订阅价格JSON数据\n  static parseSubscriptionPrices(pricesJson: unknown): { daily?: number; weekly?: number; monthly?: number; yearly?: number } | undefined {\n    if (!pricesJson) return undefined\n    \n    try {\n      if (typeof pricesJson === 'string') {\n        return JSON.parse(pricesJson)\n      }\n      return typeof pricesJson === 'object' ? pricesJson as { daily?: number; weekly?: number; monthly?: number; yearly?: number } : undefined\n    } catch (error) {\n      console.error('Error parsing subscription prices:', error)\n      return undefined\n    }\n  }\n\n  // 更新产品\n  static async updateProduct(productId: string, updates: Partial<{\n    name: string\n    description: string\n    price: number\n    currency: string\n    category: string\n    status: 'active' | 'inactive'\n    images: Array<{ url: string; alt: string }>\n    pricing_model: 'one_time' | 'subscription'\n    subscription_period: 'daily' | 'weekly' | 'monthly' | 'yearly'\n    subscription_prices: { daily?: number; weekly?: number; monthly?: number; yearly?: number }\n    subscription_price_per_period: number | null\n    subscription_duration: number | null\n    product_type: 'product' | 'subscription'\n  }>): Promise<Project> {\n    if (!supabase) {\n      throw new Error('Supabase not configured')\n    }\n\n    try {\n      const updateData: Record<string, unknown> = { ...updates }\n      \n      // Convert images array to JSON if provided\n      if (updates.images) {\n        updateData.images = JSON.stringify(updates.images)\n      }\n      \n      // Convert subscription_prices to JSON if provided\n      if (updates.subscription_prices) {\n        updateData.subscription_prices = JSON.stringify(updates.subscription_prices)\n      }\n\n      const { data, error } = await supabase\n        .from('products')\n        .update(updateData)\n        .eq('id', productId)\n        .select()\n        .single()\n\n      if (error) {\n        console.error('Error updating product:', error)\n        throw new Error(`Failed to update product: ${error.message}`)\n      }\n\n      return ProductsService.transformProduct(data)\n    } catch (error) {\n      console.error('Error in updateProduct:', error)\n      throw error\n    }\n  }\n\n  // 删除产品（软删除）\n  static async deleteProduct(productId: string): Promise<void> {\n    if (!supabase) {\n      throw new Error('Supabase not configured')\n    }\n\n    try {\n      const { error } = await supabase\n        .from('products')\n        .update({ status: 'deleted' })\n        .eq('id', productId)\n\n      if (error) {\n        console.error('Error deleting product:', error)\n        throw new Error(`Failed to delete product: ${error.message}`)\n      }\n    } catch (error) {\n      console.error('Error in deleteProduct:', error)\n      throw error\n    }\n  }\n\n  // 永久删除产品\n  static async permanentDeleteProduct(productId: string): Promise<void> {\n    if (!supabase) {\n      throw new Error('Supabase not configured')\n    }\n\n    try {\n      const { error } = await supabase\n        .from('products')\n        .delete()\n        .eq('id', productId)\n\n      if (error) {\n        console.error('Error permanently deleting product:', error)\n        throw new Error(`Failed to permanently delete product: ${error.message}`)\n      }\n    } catch (error) {\n      console.error('Error in permanentDeleteProduct:', error)\n      throw error\n    }\n  }\n}"],"names":[],"mappings":";;;AAAA;;AAYO,MAAM;IACX,SAAS;IACT,aAAa,cAA6D;YAAjD,SAAA,iEAAyB,CAAC;QACjD,IAAI,CAAC,yHAAA,CAAA,WAAQ,EAAE;YACb,QAAQ,IAAI,CAAC;YACb,OAAO,EAAE;QACX;QAEA,IAAI;YACF,IAAI,QAAQ,yHAAA,CAAA,WAAQ,CACjB,IAAI,CAAC,YACL,MAAM,CAAC,KACP,EAAE,CAAC,UAAU;YAEhB,QAAQ;YACR,IAAI,OAAO,QAAQ,EAAE;gBACnB,QAAQ,MAAM,EAAE,CAAC,YAAY,OAAO,QAAQ;YAC9C;YAEA,IAAI,OAAO,IAAI,IAAI,OAAO,IAAI,KAAK,OAAO;gBACxC,QAAQ,MAAM,EAAE,CAAC,QAAQ,OAAO,IAAI;YACtC;YAEA,OAAO;YACP,IAAI,OAAO,MAAM,EAAE;gBACjB,QAAQ,MAAM,KAAK,CAAC,OAAO,MAAM,EAAE;oBACjC,WAAW,OAAO,SAAS,KAAK;gBAClC;YACF,OAAO;gBACL,YAAY;gBACZ,QAAQ,MAAM,KAAK,CAAC,cAAc;oBAAE,WAAW;gBAAM;YACvD;YAEA,OAAO;YACP,IAAI,OAAO,KAAK,EAAE;gBAChB,QAAQ,MAAM,KAAK,CAAC,OAAO,KAAK;YAClC;YACA,IAAI,OAAO,MAAM,EAAE;gBACjB,QAAQ,MAAM,KAAK,CAAC,OAAO,MAAM,EAAE,OAAO,MAAM,GAAG,CAAC,OAAO,KAAK,IAAI,EAAE,IAAI;YAC5E;YAEA,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM;YAE9B,IAAI,OAAO;gBACT,QAAQ,KAAK,CAAC,4BAA4B;gBAC1C,OAAO,EAAE;YACX;YAEA,OAAO,CAAA,iBAAA,2BAAA,KAAM,GAAG,CAAC,CAAA,OAAQ,gBAAgB,gBAAgB,CAAC,WAAU,EAAE;QACxE,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,yBAAyB;YACvC,OAAO,EAAE;QACX;IACF;IAEA,iBAAiB;IACjB,aAAa,gBAAgB,MAAc,EAA8C;YAA5C,iBAAA,iEAAiB;QAC5D,IAAI,CAAC,yHAAA,CAAA,WAAQ,EAAE;YACb,QAAQ,IAAI,CAAC;YACb,OAAO,EAAE;QACX;QAEA,IAAI;YACF,IAAI,QAAQ,yHAAA,CAAA,WAAQ,CACjB,IAAI,CAAC,YACL,MAAM,CAAC,KACP,EAAE,CAAC,aAAa;YAEnB,IAAI,CAAC,gBAAgB;gBACnB,QAAQ,MAAM,GAAG,CAAC,UAAU;YAC9B;YAEA,QAAQ,MAAM,KAAK,CAAC,cAAc;gBAAE,WAAW;YAAM;YAErD,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM;YAE9B,IAAI,OAAO;gBACT,QAAQ,KAAK,CAAC,iCAAiC;gBAC/C,OAAO,EAAE;YACX;YAEA,OAAO,CAAA,iBAAA,2BAAA,KAAM,GAAG,CAAC,CAAA,OAAQ,gBAAgB,gBAAgB,CAAC,WAAU,EAAE;QACxE,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,6BAA6B;YAC3C,OAAO,EAAE;QACX;IACF;IAEA,aAAa;IACb,aAAa,eAAe,EAAU,EAA2B;QAC/D,IAAI,CAAC,yHAAA,CAAA,WAAQ,EAAE;YACb,QAAQ,IAAI,CAAC;YACb,OAAO;QACT;QAEA,IAAI;YACF,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,yHAAA,CAAA,WAAQ,CACnC,IAAI,CAAC,YACL,MAAM,CAAC,KACP,EAAE,CAAC,MAAM,IACT,EAAE,CAAC,UAAU,UACb,MAAM;YAET,IAAI,OAAO;gBACT,QAAQ,KAAK,CAAC,2BAA2B;gBACzC,OAAO;YACT;YAEA,OAAO,OAAO,gBAAgB,gBAAgB,CAAC,QAAQ;QACzD,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,4BAA4B;YAC1C,OAAO;QACT;IACF;IAEA,WAAW;IACX,aAAa,eAAe,SAAiB,EAAiB;QAC5D,IAAI,CAAC,yHAAA,CAAA,WAAQ,EAAE;QAEf,IAAI;YACF,MAAM,yHAAA,CAAA,WAAQ,CAAC,GAAG,CAAC,2BAA2B;gBAC5C,YAAY;YACd;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,6BAA6B;QAC7C;IACF;IAEA,WAAW;IACX,aAAa,WAAW,SAAiB,EAAE,OAAgB,EAAiB;QAC1E,IAAI,CAAC,yHAAA,CAAA,WAAQ,EAAE;QAEf,IAAI;YACF,MAAM,yHAAA,CAAA,WAAQ,CAAC,GAAG,CAAC,uBAAuB;gBACxC,YAAY;gBACZ,WAAW,CAAC,QAAQ,uBAAuB;YAC7C;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,wBAAwB;QACxC;IACF;IAEA,WAAW;IACX,aAAa,gBAAmC;QAC9C,IAAI,CAAC,yHAAA,CAAA,WAAQ,EAAE,OAAO,EAAE;QAExB,IAAI;YACF,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,yHAAA,CAAA,WAAQ,CACnC,IAAI,CAAC,YACL,MAAM,CAAC,YACP,EAAE,CAAC,UAAU;YAEhB,IAAI,OAAO;gBACT,QAAQ,KAAK,CAAC,8BAA8B;gBAC5C,OAAO,EAAE;YACX;YAEA,QAAQ;YACR,MAAM,aAAa;mBAAI,IAAI,IAAI,KAAK,GAAG,CAAC,CAAA,OAAQ,KAAK,QAAQ;aAAG;YAChE,OAAO,WAAW,MAAM,CAAC,SAAS,IAAI;QACxC,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,2BAA2B;YACzC,OAAO,EAAE;QACX;IACF;IAEA,OAAO;IACP,aAAa,eAAe,KAAa,EAAmD;YAAjD,SAAA,iEAAyB,CAAC;QACnE,IAAI,CAAC,yHAAA,CAAA,WAAQ,IAAI,CAAC,MAAM,IAAI,IAAI;YAC9B,OAAO,IAAI,CAAC,WAAW,CAAC;QAC1B;QAEA,IAAI;YACF,IAAI,UAAU,yHAAA,CAAA,WAAQ,CACnB,IAAI,CAAC,YACL,MAAM,CAAC,KACP,EAAE,CAAC,UAAU,UACb,EAAE,CAAC,AAAC,eAA2C,OAA7B,OAAM,yBAAoD,OAA7B,OAAM,yBAA6B,OAAN,OAAM;YAErF,QAAQ;YACR,IAAI,OAAO,QAAQ,EAAE;gBACnB,UAAU,QAAQ,EAAE,CAAC,YAAY,OAAO,QAAQ;YAClD;YAEA,IAAI,OAAO,IAAI,IAAI,OAAO,IAAI,KAAK,OAAO;gBACxC,UAAU,QAAQ,EAAE,CAAC,QAAQ,OAAO,IAAI;YAC1C;YAEA,OAAO;YACP,IAAI,OAAO,MAAM,EAAE;gBACjB,UAAU,QAAQ,KAAK,CAAC,OAAO,MAAM,EAAE;oBACrC,WAAW,OAAO,SAAS,KAAK;gBAClC;YACF,OAAO;gBACL,UAAU,QAAQ,KAAK,CAAC,cAAc;oBAAE,WAAW;gBAAM;YAC3D;YAEA,OAAO;YACP,IAAI,OAAO,KAAK,EAAE;gBAChB,UAAU,QAAQ,KAAK,CAAC,OAAO,KAAK;YACtC;YAEA,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM;YAE9B,IAAI,OAAO;gBACT,QAAQ,KAAK,CAAC,6BAA6B;gBAC3C,OAAO,EAAE;YACX;YAEA,OAAO,CAAA,iBAAA,2BAAA,KAAM,GAAG,CAAC,CAAA,OAAQ,gBAAgB,gBAAgB,CAAC,WAAU,EAAE;QACxE,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,4BAA4B;YAC1C,OAAO,EAAE;QACX;IACF;IAEA,kBAAkB;IAClB,OAAO,iBAAiB,SAAkC,EAAW;QACnE,MAAM,SAAS,gBAAgB,WAAW,CAAC,UAAU,MAAM;QAC3D,MAAM,aAAa,OAAO,MAAM,GAAG,IAAI,MAAM,CAAC,EAAE,CAAC,GAAG,GAAG;QAEvD,OAAO;YACL,IAAI,UAAU,EAAE;YAChB,MAAM,UAAU,IAAI;YACpB,QAAQ,UAAU,WAAW;YAC7B,WAAW,UAAU,SAAS;YAC9B,aAAa,UAAU,WAAW;YAClC,aAAa,UAAU,WAAW;YAClC,OAAO,WAAW,UAAU,KAAK;YACjC,UAAU,UAAU,QAAQ;YAC5B,UAAU,UAAU,QAAQ;YAC5B,MAAM,UAAU,IAAI;YACpB,OAAO;YACP,WAAW;YACX,QAAQ;YACR,MAAM,gBAAgB,SAAS,CAAC,UAAU,IAAI;YAC9C,OAAO,AAAC,UAAU,KAAK,IAAe;YACtC,OAAO,AAAC,UAAU,KAAK,IAAe;YACtC,QAAQ,WAAW,AAAC,UAAU,MAAM,IAAe,QAAQ;YAC3D,UAAU;YACV,QAAQ,UAAU,MAAM;YACxB,YAAY,UAAU,UAAU;YAChC,YAAY,UAAU,UAAU;YAChC,SAAS;YACT,cAAc,UAAU,YAAY;YACpC,eAAe,UAAU,aAAa;YACtC,qBAAqB,UAAU,mBAAmB;YAClD,+BAA+B,UAAU,6BAA6B,GAAG,WAAW,UAAU,6BAA6B,IAAc;YACzI,uBAAuB,UAAU,qBAAqB;YACtD,qBAAqB,gBAAgB,uBAAuB,CAAC,UAAU,mBAAmB;QAC5F;IACF;IAEA,aAAa;IACb,OAAO,UAAU,QAAiB,EAAS;QACzC,IAAI,CAAC,UAAU,OAAO,EAAE;QAExB,IAAI;YACF,IAAI,OAAO,aAAa,UAAU;gBAChC,OAAO,KAAK,KAAK,CAAC;YACpB;YACA,OAAO,MAAM,OAAO,CAAC,YAAY,WAAW,EAAE;QAChD,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,uBAAuB;YACrC,OAAO,EAAE;QACX;IACF;IAEA,aAAa;IACb,OAAO,YAAY,UAAmB,EAAkB;QACtD,IAAI,CAAC,YAAY,OAAO,EAAE;QAE1B,IAAI;YACF,IAAI,OAAO,eAAe,UAAU;gBAClC,OAAO,KAAK,KAAK,CAAC;YACpB;YACA,OAAO,MAAM,OAAO,CAAC,cAAc,aAAa,EAAE;QACpD,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,yBAAyB;YACvC,OAAO,EAAE;QACX;IACF;IAEA,eAAe;IACf,OAAO,wBAAwB,UAAmB,EAAsF;QACtI,IAAI,CAAC,YAAY,OAAO;QAExB,IAAI;YACF,IAAI,OAAO,eAAe,UAAU;gBAClC,OAAO,KAAK,KAAK,CAAC;YACpB;YACA,OAAO,OAAO,eAAe,WAAW,aAAuF;QACjI,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,sCAAsC;YACpD,OAAO;QACT;IACF;IAEA,OAAO;IACP,aAAa,cAAc,SAAiB,EAAE,OAc5C,EAAoB;QACpB,IAAI,CAAC,yHAAA,CAAA,WAAQ,EAAE;YACb,MAAM,IAAI,MAAM;QAClB;QAEA,IAAI;YACF,MAAM,aAAsC;gBAAE,GAAG,OAAO;YAAC;YAEzD,2CAA2C;YAC3C,IAAI,QAAQ,MAAM,EAAE;gBAClB,WAAW,MAAM,GAAG,KAAK,SAAS,CAAC,QAAQ,MAAM;YACnD;YAEA,kDAAkD;YAClD,IAAI,QAAQ,mBAAmB,EAAE;gBAC/B,WAAW,mBAAmB,GAAG,KAAK,SAAS,CAAC,QAAQ,mBAAmB;YAC7E;YAEA,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,yHAAA,CAAA,WAAQ,CACnC,IAAI,CAAC,YACL,MAAM,CAAC,YACP,EAAE,CAAC,MAAM,WACT,MAAM,GACN,MAAM;YAET,IAAI,OAAO;gBACT,QAAQ,KAAK,CAAC,2BAA2B;gBACzC,MAAM,IAAI,MAAM,AAAC,6BAA0C,OAAd,MAAM,OAAO;YAC5D;YAEA,OAAO,gBAAgB,gBAAgB,CAAC;QAC1C,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,2BAA2B;YACzC,MAAM;QACR;IACF;IAEA,YAAY;IACZ,aAAa,cAAc,SAAiB,EAAiB;QAC3D,IAAI,CAAC,yHAAA,CAAA,WAAQ,EAAE;YACb,MAAM,IAAI,MAAM;QAClB;QAEA,IAAI;YACF,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,yHAAA,CAAA,WAAQ,CAC7B,IAAI,CAAC,YACL,MAAM,CAAC;gBAAE,QAAQ;YAAU,GAC3B,EAAE,CAAC,MAAM;YAEZ,IAAI,OAAO;gBACT,QAAQ,KAAK,CAAC,2BAA2B;gBACzC,MAAM,IAAI,MAAM,AAAC,6BAA0C,OAAd,MAAM,OAAO;YAC5D;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,2BAA2B;YACzC,MAAM;QACR;IACF;IAEA,SAAS;IACT,aAAa,uBAAuB,SAAiB,EAAiB;QACpE,IAAI,CAAC,yHAAA,CAAA,WAAQ,EAAE;YACb,MAAM,IAAI,MAAM;QAClB;QAEA,IAAI;YACF,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,yHAAA,CAAA,WAAQ,CAC7B,IAAI,CAAC,YACL,MAAM,GACN,EAAE,CAAC,MAAM;YAEZ,IAAI,OAAO;gBACT,QAAQ,KAAK,CAAC,uCAAuC;gBACrD,MAAM,IAAI,MAAM,AAAC,yCAAsD,OAAd,MAAM,OAAO;YACxE;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,oCAAoC;YAClD,MAAM;QACR;IACF;AACF","debugId":null}},
    {"offset": {"line": 4669, "column": 0}, "map": {"version":3,"sources":["file:///Users/liyao/Code/workwork/frontend/Growth_OS/src/components/ProjectGrid.tsx"],"sourcesContent":["import { useEffect, useState } from 'react'\nimport { ProjectCard } from './ProjectCard'\nimport { Project, ProductZone } from '@/types'\nimport { ProductsService } from '@/lib/products'\n\nexport interface ProjectGridProps {\n  products: Project[]\n  activeZone?: ProductZone\n  sortBy?: 'time' | 'price' | 'likes' | 'views'\n  initialOpenProductId?: string\n}\n\nexport function ProjectGrid({ products, activeZone = 'all', sortBy = 'time', initialOpenProductId }: ProjectGridProps) {\n  const [fallbackProducts, setFallbackProducts] = useState<Project[]>([])\n  const [loading, setLoading] = useState(false)\n\n  // 如果没有收到数据，直接在这里获取（使用同样的筛选条件）\n  useEffect(() => {\n    if (!Array.isArray(products) || products.length === 0) {\n      setLoading(true)\n      \n      const sortField = sortBy === 'time' ? 'created_at' : \n                       sortBy === 'price' ? 'price' :\n                       sortBy === 'likes' ? 'likes' : 'views'\n      \n      ProductsService.getProducts({\n        zone: activeZone,\n        sortBy: sortField,\n        sortOrder: 'desc',\n        limit: 50\n      }).then(data => {\n        setFallbackProducts(data)\n        setLoading(false)\n      }).catch(error => {\n        console.error('ProjectGrid failed to fetch products:', error)\n        setLoading(false)\n      })\n    }\n  }, [products, activeZone, sortBy])\n\n  // 使用传入的数据或者自己获取的数据\n  const finalProducts = Array.isArray(products) && products.length > 0 ? products : fallbackProducts\n  \n  // 如果正在加载\n  if (loading) {\n    return (\n      <div className=\"px-6 py-8\">\n        <div className=\"text-center text-white\">\n          <p>Loading products...</p>\n        </div>\n      </div>\n    )\n  }\n\n  // 如果没有产品\n  if (!Array.isArray(finalProducts) || finalProducts.length === 0) {\n    return (\n      <div className=\"px-6 py-8\">\n        <div className=\"text-center text-white\">\n          <p>No products found in this category.</p>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"px-6 py-8\">\n      <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 justify-items-center max-w-7xl mx-auto\">\n        {finalProducts.map((project) => (\n          <ProjectCard \n            key={project.id} \n            {...project} \n            initialOpen={initialOpenProductId === project.id}\n          />\n        ))}\n      </div>\n    </div>\n  )\n}"],"names":[],"mappings":";;;;AAAA;AACA;AAEA;;;;;;AASO,SAAS,YAAY,KAAyF;QAAzF,EAAE,QAAQ,EAAE,aAAa,KAAK,EAAE,SAAS,MAAM,EAAE,oBAAoB,EAAoB,GAAzF;;IAC1B,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAa,EAAE;IACtE,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAEvC,8BAA8B;IAC9B,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;iCAAE;YACR,IAAI,CAAC,MAAM,OAAO,CAAC,aAAa,SAAS,MAAM,KAAK,GAAG;gBACrD,WAAW;gBAEX,MAAM,YAAY,WAAW,SAAS,eACrB,WAAW,UAAU,UACrB,WAAW,UAAU,UAAU;gBAEhD,yHAAA,CAAA,kBAAe,CAAC,WAAW,CAAC;oBAC1B,MAAM;oBACN,QAAQ;oBACR,WAAW;oBACX,OAAO;gBACT,GAAG,IAAI;6CAAC,CAAA;wBACN,oBAAoB;wBACpB,WAAW;oBACb;4CAAG,KAAK;6CAAC,CAAA;wBACP,QAAQ,KAAK,CAAC,yCAAyC;wBACvD,WAAW;oBACb;;YACF;QACF;gCAAG;QAAC;QAAU;QAAY;KAAO;IAEjC,mBAAmB;IACnB,MAAM,gBAAgB,MAAM,OAAO,CAAC,aAAa,SAAS,MAAM,GAAG,IAAI,WAAW;IAElF,SAAS;IACT,IAAI,SAAS;QACX,qBACE,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;8BAAE;;;;;;;;;;;;;;;;IAIX;IAEA,SAAS;IACT,IAAI,CAAC,MAAM,OAAO,CAAC,kBAAkB,cAAc,MAAM,KAAK,GAAG;QAC/D,qBACE,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;8BAAE;;;;;;;;;;;;;;;;IAIX;IAEA,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YAAI,WAAU;sBACZ,cAAc,GAAG,CAAC,CAAC,wBAClB,6LAAC,oIAAA,CAAA,cAAW;oBAET,GAAG,OAAO;oBACX,aAAa,yBAAyB,QAAQ,EAAE;mBAF3C,QAAQ,EAAE;;;;;;;;;;;;;;;AAQ3B;GAlEgB;KAAA","debugId":null}},
    {"offset": {"line": 4801, "column": 0}, "map": {"version":3,"sources":["file:///Users/liyao/Code/workwork/frontend/Growth_OS/src/components/HomeContent.tsx"],"sourcesContent":["'use client'\n\nimport { useEffect, useState } from 'react'\nimport { useSearchParams } from 'next/navigation'\nimport { Header } from '@/components/Header'\nimport { ControlBar } from '@/components/ControlBar'\nimport { ProjectGrid } from '@/components/ProjectGrid'\nimport { ProductsService } from '@/lib/products'\nimport { Project, ProductZone } from '@/types'\n\nexport function HomeContent() {\n  const searchParams = useSearchParams()\n  const [products, setProducts] = useState<Project[]>([])\n  const [loading, setLoading] = useState(true)\n  const [sortBy, setSortBy] = useState<'time' | 'price' | 'likes' | 'views'>('time')\n  const [activeZone, setActiveZone] = useState<ProductZone>('all')\n  const [searchQuery, setSearchQuery] = useState('')\n  const [debouncedSearchQuery, setDebouncedSearchQuery] = useState('')\n  const [isSearching, setIsSearching] = useState(false)\n  \n  // 获取URL参数中的产品ID\n  const initialOpenProductId = searchParams.get('product')\n\n  // 防抖处理搜索查询\n  useEffect(() => {\n    if (searchQuery !== debouncedSearchQuery) {\n      setIsSearching(true)\n    }\n    \n    const timer = setTimeout(() => {\n      setDebouncedSearchQuery(searchQuery)\n    }, 500) // 500ms 延迟\n\n    return () => clearTimeout(timer)\n  }, [searchQuery, debouncedSearchQuery])\n\n  useEffect(() => {\n    const loadProducts = async () => {\n      setLoading(true)\n      try {\n        const sortField = sortBy === 'time' ? 'created_at' : \n                         sortBy === 'price' ? 'price' :\n                         sortBy === 'likes' ? 'likes' : 'views'\n        \n        let data: Project[]\n        if (debouncedSearchQuery.trim()) {\n          // 如果有搜索查询，使用搜索功能\n          data = await ProductsService.searchProducts(debouncedSearchQuery, {\n            zone: activeZone,\n            sortBy: sortField,\n            sortOrder: 'desc',\n            limit: 50\n          })\n        } else {\n          // 否则获取所有产品\n          data = await ProductsService.getProducts({\n            zone: activeZone,\n            sortBy: sortField,\n            sortOrder: 'desc',\n            limit: 50\n          })\n        }\n        \n        // 确保data是数组，如果不是则使用空数组\n        const finalData = Array.isArray(data) ? data : []\n        setProducts(finalData)\n      } catch (error) {\n        console.error('Failed to load products:', error)\n        // 发生错误时设置为空数组\n        setProducts([])\n      } finally {\n        setLoading(false)\n        setIsSearching(false)\n      }\n    }\n\n    loadProducts()\n  }, [sortBy, activeZone, debouncedSearchQuery])\n\n  const handleFilterChange = (filter: 'time' | 'price' | 'likes' | 'views') => {\n    setSortBy(filter)\n  }\n\n  const handleZoneChange = (zone: ProductZone) => {\n    setActiveZone(zone)\n  }\n\n  const handleSearch = (query: string) => {\n    setSearchQuery(query)\n    // 不再在这里设置loading，让防抖机制处理\n  }\n\n  const handleCreateProject = () => {\n    window.location.href = '/create'\n  }\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-bg-blue flex items-center justify-center\">\n        <div className=\"text-white text-xl\">Loading...</div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"min-h-screen bg-bg-blue\">\n      <div className=\"space-y-2\">\n        <Header />\n        <ControlBar \n          onFilterChange={handleFilterChange}\n          onCreateProject={handleCreateProject}\n          onSearch={handleSearch}\n          activeFilter={sortBy}\n          isSearching={isSearching}\n          activeZone={activeZone}\n          onZoneChange={handleZoneChange}\n        />\n        <ProjectGrid \n          products={products || []} \n          activeZone={activeZone}\n          sortBy={sortBy}\n        />\n      </div>\n    </div>\n  )\n}"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAPA;;;;;;;AAUO,SAAS;;IACd,MAAM,eAAe,CAAA,GAAA,qIAAA,CAAA,kBAAe,AAAD;IACnC,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAa,EAAE;IACtD,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACvC,MAAM,CAAC,QAAQ,UAAU,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAwC;IAC3E,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAe;IAC1D,MAAM,CAAC,aAAa,eAAe,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAC/C,MAAM,CAAC,sBAAsB,wBAAwB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACjE,MAAM,CAAC,aAAa,eAAe,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAE/C,gBAAgB;IAChB,MAAM,uBAAuB,aAAa,GAAG,CAAC;IAE9C,WAAW;IACX,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;iCAAE;YACR,IAAI,gBAAgB,sBAAsB;gBACxC,eAAe;YACjB;YAEA,MAAM,QAAQ;+CAAW;oBACvB,wBAAwB;gBAC1B;8CAAG,KAAK,WAAW;;YAEnB;yCAAO,IAAM,aAAa;;QAC5B;gCAAG;QAAC;QAAa;KAAqB;IAEtC,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;iCAAE;YACR,MAAM;sDAAe;oBACnB,WAAW;oBACX,IAAI;wBACF,MAAM,YAAY,WAAW,SAAS,eACrB,WAAW,UAAU,UACrB,WAAW,UAAU,UAAU;wBAEhD,IAAI;wBACJ,IAAI,qBAAqB,IAAI,IAAI;4BAC/B,iBAAiB;4BACjB,OAAO,MAAM,yHAAA,CAAA,kBAAe,CAAC,cAAc,CAAC,sBAAsB;gCAChE,MAAM;gCACN,QAAQ;gCACR,WAAW;gCACX,OAAO;4BACT;wBACF,OAAO;4BACL,WAAW;4BACX,OAAO,MAAM,yHAAA,CAAA,kBAAe,CAAC,WAAW,CAAC;gCACvC,MAAM;gCACN,QAAQ;gCACR,WAAW;gCACX,OAAO;4BACT;wBACF;wBAEA,uBAAuB;wBACvB,MAAM,YAAY,MAAM,OAAO,CAAC,QAAQ,OAAO,EAAE;wBACjD,YAAY;oBACd,EAAE,OAAO,OAAO;wBACd,QAAQ,KAAK,CAAC,4BAA4B;wBAC1C,cAAc;wBACd,YAAY,EAAE;oBAChB,SAAU;wBACR,WAAW;wBACX,eAAe;oBACjB;gBACF;;YAEA;QACF;gCAAG;QAAC;QAAQ;QAAY;KAAqB;IAE7C,MAAM,qBAAqB,CAAC;QAC1B,UAAU;IACZ;IAEA,MAAM,mBAAmB,CAAC;QACxB,cAAc;IAChB;IAEA,MAAM,eAAe,CAAC;QACpB,eAAe;IACf,yBAAyB;IAC3B;IAEA,MAAM,sBAAsB;QAC1B,OAAO,QAAQ,CAAC,IAAI,GAAG;IACzB;IAEA,IAAI,SAAS;QACX,qBACE,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBAAI,WAAU;0BAAqB;;;;;;;;;;;IAG1C;IAEA,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YAAI,WAAU;;8BACb,6LAAC,+HAAA,CAAA,SAAM;;;;;8BACP,6LAAC,mIAAA,CAAA,aAAU;oBACT,gBAAgB;oBAChB,iBAAiB;oBACjB,UAAU;oBACV,cAAc;oBACd,aAAa;oBACb,YAAY;oBACZ,cAAc;;;;;;8BAEhB,6LAAC,oIAAA,CAAA,cAAW;oBACV,UAAU,YAAY,EAAE;oBACxB,YAAY;oBACZ,QAAQ;;;;;;;;;;;;;;;;;AAKlB;GAnHgB;;QACO,qIAAA,CAAA,kBAAe;;;KADtB","debugId":null}}]
}